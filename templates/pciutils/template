# Template file for 'pciutils'
pkgname=pciutils
version=3.1.2
distfiles="ftp://atrey.karlin.mff.cuni.cz/pub/linux/pci/$pkgname-$version.tar.gz"
build_style=custom-install
short_desc="PCI bus related utilities"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=7b682329410a39e6d61183e168342e1d125c875a35acd4c746ff1bec2ab6789d
long_desc="
 The $pkgname package contains various utilities for inspecting and
 setting devices connected to the PCI bus."

Add_dependency full glibc
Add_dependency full zlib
Add_dependency build wget
Add_dependency build which

do_install()
{
	cd $wrksrc
	sed -i -e 's/^OPT=.*/OPT=-O2 -pipe -fPIC -DPIC/g' Makefile
	./update-pciids.sh

	make ZLIB=yes SHARED=yes DNS=no PREFIX=/usr SHAREDIR=/usr/share/hwdata \
		MANDIR=/usr/share/man all || exit 1
	make PREFIX=/usr DESTDIR=${DESTDIR} SHAREDIR=/usr/share/hwdata \
		MANDIR=/usr/share/man install install-lib || exit 1
	for i in config.h header.h pci.h types.h; do
		install -D -m 644 lib/${i} ${DESTDIR}/usr/include/pci/${i}
	done
	cd ${DESTDIR}/usr/lib && \
		ln -s libpci.so.${version} libpci.so.3 && \
		ln -s libpci.so.${version} libpci.so
}
