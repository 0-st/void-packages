# Template file for 'udev'
pkgname=udev
version=137
distfiles="
http://www.kernel.org/pub/linux/utils/kernel/hotplug/udev-${version}.tar.bz2"
build_style=gnu_configure
configure_args="--exec-prefix= --without-selinux --mandir=/usr/share/man"
make_install_target="DESTDIR=$XBPS_DESTDIR/$pkgname-$version install"
short_desc="A userspace implementation of devfs"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=1aaa46da688f54f6d3b6ab727d82d011898b473952b74e812e174dd477602ebc
long_desc="
 udev is a implementation of devfs in userspace using sysfs and
 /sbin/hotplug. It requires a 2.5/2.6 kernel to run properly."

build_depends="initramfs-tools-0.92 procps-3.2.7"
run_depends="glibc-2.8 $build_depends"

post_install()
{
	local destdir=$XBPS_DESTDIR/$pkgname-$version

	# Install the initramfs-tools udev scripts.
	mkdir -p $destdir/usr/share/initramfs-tools/hooks
	mkdir -p $destdir/usr/share/initramfs-tools/scripts/init-premount
	mkdir -p $destdir/usr/share/initramfs-tools/scripts/init-bottom

	install -m 755 $XBPS_TEMPLATESDIR/udev/udev.initramfs-hook \
		$destdir/usr/share/initramfs-tools/hooks/udev
	install -m 755 $XBPS_TEMPLATESDIR/udev/udev.initramfs-premount \
		$destdir/usr/share/initramfs-tools/scripts/init-premount/udev
	install -m 755 $XBPS_TEMPLATESDIR/udev/udev.initramfs-bottom \
		$destdir/usr/share/initramfs-tools/scripts/init-bottom/udev
}
