# Template file for 'util-linux-ng'
pkgname=util-linux-ng
version=2.15
distfiles="${KERNEL_SITE}/utils/$pkgname/v2.15/$pkgname-$version.tar.bz2"
build_style=gnu_configure
configure_args="--enable-partx --enable-write --with-fsprobe=blkid"
short_desc="Miscellaneous linux utilities"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=db4dcbf99d989a8f539d7521e9e64047367fa2ccdcbb91517cdec19693a41ffd
long_desc="
 The util-linux-ng package contains miscellaneous utility programs. Among
 them are utilities for handling file systems, consoles, partitions,
 and messages."

Add_dependency full	glibc
Add_dependency full	coreutils
Add_dependency full	zlib
Add_dependency full	libblkid
Add_dependency run	ncurses-libs

post_configure()
{
	cd $wrksrc
	for f in $(grep -rl '/etc/adjtime' .); do
		sed -i -e 's@etc/adjtime@var/lib/hwclock/adjtime@g' $f
	done
}

post_install()
{
	# Move logger to /bin.
	install -d -m 755 ${DESTDIR}/bin
	mv ${DESTDIR}/usr/bin/logger ${DESTDIR}/bin
	mkdir -p ${DESTDIR}/var/lib/hwclock

	# Install the cron daily job.
	install -D -m744 ${FILESDIR}/adjtime.cron-hourly \
		${DESTDIR}/etc/cron.hourly/adjtime
}
