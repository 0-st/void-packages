# Template build file for 'gcc'
pkgname=gcc
version=4.3.2
patch_files="$pkgname-fix-amd64.diff"
distfiles="
http://ftp.gnu.org/pub/gnu/gcc/$pkgname-$version/$pkgname-$version.tar.bz2"
build_style=gnu_configure
configure_args="--enable-clocale=gnu --disable-bootstrap
 --enable-threads=posix --enable-__cxa_atexit --disable-multilib
 --enable-languages=c,c++,objc,obj-c++ --enable-tls
 --with-local-prefix=$XBPS_DESTDIR/$pkgname-$version
 --with-mpfr=$XBPS_MASTERDIR/usr --with-gmp=$XBPS_MASTERDIR/usr
 --disable-rpath --with-system-zlib --enable-shared"
short_desc="The GNU C Compiler suite"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=bfbf487731ad5dca37efe480a837417de071bd67e685d5c1df6a290707575165
long_desc="
 The GNU C Compiler suite, with support for C, C++, Fortran, ObjC."

base_chroot=yes
build_depends="gmp-4.2.4 mpfr-2.3.2 binutils-2.18"
run_depends="glibc-2.8 $build_depends"

# As specified in the LFS book, disable installing libiberty.
pre_configure()
{
	sed -i 's/install_to_$(INSTALL_DEST) //' $wrksrc/libiberty/Makefile.in
}

# Make /usr/bin/gcc -> /usr/bin/cc symlink.
post_install()
{
	cd $XBPS_DESTDIR/$pkgname-$version/usr/bin && ln -s gcc cc
}
