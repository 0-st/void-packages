# Template file for 'ConsoleKit'
pkgname=ConsoleKit
version=0.4.5
revision=9
build_style=gnu-configure
configure_args="--enable-docbook-docs --enable-pam-module
--with-systemdsystemunitdir=/usr/lib/systemd/system
--with-pam-module-dir=/usr/lib/security"
makedepends="pkg-config xmlto libX11-devel dbus-devel glib-devel dbus-glib-devel pam-devel polkit-devel zlib-devel"
short_desc="Framework for defining and tracking users, login sessions and seats"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.freedesktop.org/wiki/Software/ConsoleKit"
license="GPL-2"
distfiles="http://www.freedesktop.org/software/$pkgname/dist/$pkgname-$version.tar.bz2"
checksum=43e0780c53078e125efcec3f847e484dc3533e49b408ce6a0ab1b223686b9c38
long_desc="
 ConsoleKit is a framework for keeping track of the various users, sessions,
 and seats present on a system. It provides a mechanism for software to react
 to changes of any of these items or of any of the metadata associated with
 them."

systemd_services="console-kit-daemon.service on"
conf_files="/etc/logrotate.d/ConsoleKit"
subpackages="$pkgname-devel $pkgname-x11"
make_dirs="/var/log/${pkgname} 0755 root root"

post_install() {
	vinstall ${FILESDIR}/pam-foreground-compat.ck 755 \
		usr/lib/${pkgname}/run-session.d
	for f in seat session; do
		vmkdir etc/${pkgname}/run-${f}.d
		touch ${DESTDIR}/etc/${pkgname}/run-${f}.d/.owned
	done
	vmkdir usr/lib/${pkgname}/run-seat.d
	touch ${DESTDIR}/usr/lib/${pkgname}/run-seat.d/.owned
	vinstall ${FILESDIR}/ck.logrotate 644 etc/logrotate.d ConsoleKit
}
