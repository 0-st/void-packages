# Template file for 'ConsoleKit'
pkgname=ConsoleKit
version=0.4.5
revision=2
distfiles="http://www.freedesktop.org/software/$pkgname/dist/$pkgname-$version.tar.bz2"
build_style=gnu-configure
configure_args="--enable-docbook-docs --enable-pam-module
--with-systemdsystemunitdir=/lib/systemd/system"
short_desc="Framework for defining and tracking users, login sessions and seats"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.freedesktop.org/wiki/Software/ConsoleKit"
license="GPL-2"
checksum=43e0780c53078e125efcec3f847e484dc3533e49b408ce6a0ab1b223686b9c38
long_desc="
 ConsoleKit is a framework for keeping track of the various users, sessions,
 and seats present on a system. It provides a mechanism for software to react
 to changes of any of these items or of any of the metadata associated with
 them."

systemd_services="console-kit-daemon.service"
conf_files="/etc/logrotate.d/ConsoleKit"
keep_empty_dirs=yes
subpackages="$pkgname-devel $pkgname-x11"

Add_dependency run glibc
Add_dependency run dbus-libs
Add_dependency run dbus-glib
Add_dependency run glib
Add_dependency run pam
Add_dependency run polkit
Add_dependency run zlib

Add_dependency build pkg-config
Add_dependency build xmlto
Add_dependency build libX11-devel
Add_dependency build dbus-devel
Add_dependency build glib-devel
Add_dependency build dbus-glib-devel
Add_dependency build pam-devel
Add_dependency build polkit-devel
Add_dependency build zlib-devel

post_install()
{
	install -d ${DESTDIR}/usr/lib/ConsoleKit/run-session.d
	install -m755 ${FILESDIR}/pam-foreground-compat.ck \
		${DESTDIR}/usr/lib/ConsoleKit/run-session.d
	install -d ${DESTDIR}/etc/ConsoleKit/run-seat.d
	install -d ${DESTDIR}/etc/ConsoleKit/run-session.d

	install -D -m644 ${FILESDIR}/ck.logrotate \
		${DESTDIR}/etc/logrotate.d/ConsoleKit
	rm -rf ${DESTDIR}/var/run
}
