# Template file for 'linux-firmware'
pkgname=linux-firmware
version="$(date -u +%Y%m%d)"
short_desc="Binary firmware blobs for the Linux kernel"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.kernel.org/"
license="See /usr/share/licenses/${pkgname}"
checksum=b8b0a3b875ff74d72a57987ad705753f94cc274c97922e0e16f51381af0d42a9
long_desc="
 This package provides binary firmware blobs for misc hardware supported by
 the Linux kernel."

noarch=yes
nofetch=yes
noextract=yes

replaces="kernel-firmware>=0 radeon-firmware>=0 iwl1000-firmware>=0
iwl3945-firmware>=0 iwl4965-firmware>=0 iwl5000-firmware>=0 rt73usb-firmware>=0
iwl5150-firmware>=0 iwl6000-firmware>=0 rt2800usb>=0 rt61-firmware>=0
ar9170-firmware>=0"

Add_dependency build coreutils
Add_dependency build wget
Add_dependency build git

do_fetch() {
	url="git://git.kernel.org/pub/scm/linux/kernel/git/dwmw2/linux-firmware.git"
	msg_normal " Fetching source from $url ...\n"
	git clone ${url} ${pkgname}-${version}
}

do_install() {
	vmkdir lib/firmware
	vmkdir usr/share/licenses/${pkgname}
	vcopy "*" lib/firmware
	rm -f ${DESTDIR}/lib/firmware/GPL{,-3}
	mv ${DESTDIR}/lib/firmware/{LICEN*,WHENCE} \
		${DESTDIR}/usr/share/licenses/${pkgname}
	wget http://anonscm.debian.org/viewvc/kernel/dists/squeeze/firmware-nonfree/atheros/ar9170.fw?view=co \
		-O ${DESTDIR}/lib/firmware/ar9170.fw
}
