# Template file for 'linux-firmware'
pkgname=linux-firmware
version=20101108
distfiles=ftp://ftp.archlinux.org/other/linux-firmware/$pkgname-$version.tar.xz
build_style=custom-install
short_desc="Binary firmware blobs for the Linux kernel"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=588e8bb31fb8a5e6719bb00c2d1ce4e6d5fc1f2c5178c24fffed7f7bffce7dd7
long_desc="
 This package provides binary firmware blobs for misc hardware supported by
 the Linux kernel."

noarch=yes

replaces="kernel-firmware>=0 radeon-firmware>=0 iwl1000-firmware>=0
iwl3945-firmware>=0 iwl4965-firmware>=0 iwl5000-firmware>=0 rt73usb-firmware>=0
iwl5150-firmware>=0 iwl6000-firmware>=0 rt2800usb>=0 rt61-firmware>=0
ar9170-firmware>=0"

Add_dependency build xz

do_install()
{
	cd ${wrksrc} || return 1

	install -d ${DESTDIR}/lib/firmware
	install -d ${DESTDIR}/usr/share/licenses/${pkgname}
	cp -a * ${DESTDIR}/lib/firmware
	rm -f ${DESTDIR}/lib/firmware/GPL
	mv ${DESTDIR}/lib/firmware/{LICEN*,WHENCE} \
		${DESTDIR}/usr/share/licenses/${pkgname}
	# Symlinks for Broadcom firmware
	ln -s bcm43xx-0-610-809-0.fw \
		${DESTDIR}/lib/firmware/brcm/bcm43xx-0.fw
	ln -s bcm43xx_hdr-0-610-809-0.fw \
		${DESTDIR}/lib/firmware/brcm/bcm43xx_hdr-0.fw

	${XBPS_FETCH_CMD} http://www.kernel.org/pub/linux/kernel/people/mcgrof/firmware/ar9170/ar9170.fw
	mv ar9170.fw ${DESTDIR}/lib/firmware
}
