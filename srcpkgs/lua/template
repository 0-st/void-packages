# Template file for 'lua'
pkgname=lua
version=5.1.5
patch_args="-Np1"
distfiles="http://www.lua.org/ftp/$pkgname-$version.tar.gz"
makedepends="ncurses-devel readline-devel"
revision=1
short_desc="Lua is a powerful, fast, lightweight, embeddable scripting language."
maintainer="Robert Djubek <envy1988@gmail.com>"
homepage="http://www.lua.org"
license="MIT"
checksum=2640fc56a795f29d28ef15e13c34a47e223960b0240e8cb0a82d9b0738695333
long_desc="
Lua combines simple procedural syntax with powerful data description 
constructs based on associative arrays and extensible semantics. Lua 
is dynamically typed, runs by interpreting bytecode for a register-based
virtual machine, and has automatic memory management with incremental
garbage collection, making it ideal for configuration, scripting, and 
rapid prototyping."

subpackages="lua-devel"


do_build() {
	export CFLAGS="$XBPS_CFLAGS -fPIC"
	make INSTALL_DATA="cp -d" LUA_SO=liblua.so ${makejobs} linux
}

do_install() {
	make INSTALL_DATA="cp -d" INSTALL_TOP="${DESTDIR}/usr" \
		TO_LIB="liblua.a liblua.so liblua.so.5.1" \
		INSTALL_MAN="${DESTDIR}/usr/share/man/man1" install
	install -Dm 644 etc/lua.pc ${DESTDIR}/usr/lib/pkgconfig/lua.pc
	install -Dm644 COPYRIGHT \
		${DESTDIR}/usr/share/licenses/${pkgname}/COPYRIGHT

	# Install the documentation
	mkdir -p ${DESTDIR}/usr/share/doc/lua
	cp -R doc/* ${DESTDIR}/usr/share/doc/lua
	cd ${DESTDIR}/usr/lib && ln -sf liblua.so.5.1 liblua.so.5
}
