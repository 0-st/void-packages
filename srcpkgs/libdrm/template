# Template build file for 'libdrm'.
pkgname=libdrm
version=2.4.33
distfiles="http://dri.freedesktop.org/libdrm/$pkgname-$version.tar.bz2"
build_style=gnu-configure
configure_args="--enable-udev --enable-vmwgfx-experimental-api
--enable-nouveau-experimental-api"
short_desc="Userspace interface to kernel DRM services"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://dri.freedesktop.org/"
license="MIT"
checksum=2d7b9d94ada0e3a6ede6243509883df2ded01c2983e24322759a366283898fea
long_desc="
 This package provides a library which offers a userspace interface
 to kernel DRM (Direct Rendering Manager) services for access to
 graphics hardware."

subpackages="$pkgname-devel"

Add_dependency build automake
Add_dependency build pkg-config
Add_dependency build glibc-devel
Add_dependency build libudev-devel
Add_dependency build libpciaccess-devel

pre_configure() {
	sed -i "/.*PTHREADSTUBS.*/d" configure.ac
	sed -i -e "s/@PTHREADSTUBS_LIBS@//g" \
		-e "s/\$(PTHREADSTUBS_CFLAGS)//g" \
		nouveau/Makefile.am radeon/Makefile.am intel/Makefile.am
	autoreconf -fi
	sed -i 's/tests//g' Makefile.in
}
