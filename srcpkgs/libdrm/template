# Template build file for 'libdrm'.
pkgname=libdrm
version=2.4.35
revision=1
build_style=gnu-configure
configure_args="--enable-udev --enable-vmwgfx-experimental-api"
makedepends="automake pkg-config glibc-devel libudev-devel libpciaccess-devel"
short_desc="Userspace interface to kernel DRM services"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://dri.freedesktop.org/"
license="MIT"
distfiles="http://dri.freedesktop.org/libdrm/$pkgname-$version.tar.bz2"
checksum=c390aee132f05910edb09398b70e108c6b53f9b69b21914a9ea3165eed6f1b21
long_desc="
 This package provides a library which offers a userspace interface
 to kernel DRM (Direct Rendering Manager) services for access to
 graphics hardware."

subpackages="$pkgname-devel"

pre_configure() {
	sed -i "/.*PTHREADSTUBS.*/d" configure.ac
	sed -i -e "s/@PTHREADSTUBS_LIBS@//g" \
		-e "s/\$(PTHREADSTUBS_CFLAGS)//g" \
		nouveau/Makefile.am radeon/Makefile.am intel/Makefile.am
	autoreconf -fi
	sed -i 's/tests//g' Makefile.in
}
