# Template build file for 'libdrm'.
pkgname=libdrm
version=2.4.34
distfiles="http://dri.freedesktop.org/libdrm/$pkgname-$version.tar.bz2"
build_style=gnu-configure
configure_args="--enable-udev --enable-vmwgfx-experimental-api"
short_desc="Userspace interface to kernel DRM services"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://dri.freedesktop.org/"
license="MIT"
checksum=a468570e7c85107b7c2f8eaceeebaa8f8a0da86482618f445bb74fa0b0d0f8d0
long_desc="
 This package provides a library which offers a userspace interface
 to kernel DRM (Direct Rendering Manager) services for access to
 graphics hardware."

subpackages="$pkgname-devel"

Add_dependency build automake
Add_dependency build pkg-config
Add_dependency build glibc-devel
Add_dependency build libudev-devel
Add_dependency build libpciaccess-devel

pre_configure() {
	sed -i "/.*PTHREADSTUBS.*/d" configure.ac
	sed -i -e "s/@PTHREADSTUBS_LIBS@//g" \
		-e "s/\$(PTHREADSTUBS_CFLAGS)//g" \
		nouveau/Makefile.am radeon/Makefile.am intel/Makefile.am
	autoreconf -fi
	sed -i 's/tests//g' Makefile.in
}
