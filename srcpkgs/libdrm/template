# Template build file for 'libdrm'.
pkgname=libdrm
version=2.4.41
revision=1
build_style=gnu-configure
configure_args="--enable-udev --enable-vmwgfx-experimental-api"
makedepends="automake pkg-config libudev-devel libpciaccess-devel"
subpackages="$pkgname-devel"
short_desc="Userspace interface to kernel DRM services"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://dri.freedesktop.org/"
license="MIT"
distfiles="http://dri.freedesktop.org/libdrm/$pkgname-$version.tar.bz2"
checksum=52b3ca670df43fc9f5164f0f55fa40b008de297c0ceedab7c77c30bf9022f212

pre_configure() {
	sed -i "/.*PTHREADSTUBS.*/d" configure.ac
	sed -i -e "s/@PTHREADSTUBS_LIBS@//g" \
		-e "s/\$(PTHREADSTUBS_CFLAGS)//g" \
		nouveau/Makefile.am radeon/Makefile.am intel/Makefile.am
	autoreconf -fi
	sed -i 's/tests//g' Makefile.in
}
