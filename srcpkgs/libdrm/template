# Template build file for 'libdrm'.
pkgname=libdrm
version=2.4.38
revision=1
build_style=gnu-configure
configure_args="--enable-udev --enable-vmwgfx-experimental-api"
makedepends="automake pkg-config libudev-devel libpciaccess-devel"
subpackages="$pkgname-devel"
short_desc="Userspace interface to kernel DRM services"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://dri.freedesktop.org/"
license="MIT"
distfiles="http://dri.freedesktop.org/libdrm/$pkgname-$version.tar.bz2"
checksum=3e5a2f318edaf1eef41e7e6c85aa9596d6f9f8b083ec4d7d6710ffbb8921e7e9
long_desc="
 This package provides a library which offers a userspace interface
 to kernel DRM (Direct Rendering Manager) services for access to
 graphics hardware."

pre_configure() {
	sed -i "/.*PTHREADSTUBS.*/d" configure.ac
	sed -i -e "s/@PTHREADSTUBS_LIBS@//g" \
		-e "s/\$(PTHREADSTUBS_CFLAGS)//g" \
		nouveau/Makefile.am radeon/Makefile.am intel/Makefile.am
	autoreconf -fi
	sed -i 's/tests//g' Makefile.in
}
