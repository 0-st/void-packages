# Template file for 'xbps-casper'
pkgname=xbps-casper
_localver=0.25	# XBPS package version
_distver=1.236	# This should match the upstream (Ubuntu) version
version=${_localver}.${_distver}
short_desc="Run a live preinstalled system from read-only media"
maintainer="Juan RP <xtraeme@gmail.com>"
license="GPL-2"
long_desc="
 $pkgname is a modified version of Ubuntu's casper, that is able
 to run a live pre-installed system from read-only media."

noextract=yes
noarch=yes
conf_files="/etc/casper.conf"

Add_dependency full udev ">=174" # no path_id anymore
Add_dependency full initramfs-tools

do_install() {
	# /etc config files
	vinstall ${FILESDIR}/casper.conf 644 etc

	# Helpers
	install -d ${DESTDIR}/sbin
	install -m755 ${FILESDIR}/bin/* ${DESTDIR}/sbin

	# initramfs-tools hooks/scripts
	initramfsdir=${DESTDIR}/usr/share/initramfs-tools
	install -d ${initramfsdir}/hooks ${initramfsdir}/scripts/casper-bottom
	install -m755 ${FILESDIR}/hooks/* ${initramfsdir}/hooks
	install -m755 ${FILESDIR}/scripts/casper-bottom/* \
		${initramfsdir}/scripts/casper-bottom
	install -m644 ${FILESDIR}/scripts/{casper,casper-helpers} \
		${initramfsdir}/scripts
}
