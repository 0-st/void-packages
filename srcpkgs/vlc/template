# Template file for 'vlc'
pkgname=vlc
version=1.1.13
distfiles="http://download.videolan.org/pub/videolan/vlc/$version/vlc-$version.tar.bz2"
build_style=gnu-configure
configure_args="--disable-gme --disable-libtar --enable-snapshot
--disable-telepathy --disable-lua --disable-live555
--enable-dvdread --enable-flac --disable-gnomevfs --enable-v4l
--disable-jack --disable-fluidsynth --disable-portaudio"
revision=1
short_desc="VideoLan Client"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.videolan.org/vlc/"
license="GPL-2"
checksum=03edec44d463b9f5e7db56fd844c6d4ac79966638e1ac32dedcfb5847a9323c1
long_desc="
 VLC media player is a highly portable multimedia player supporting most
 audio and video formats (H.264, Ogg, DivX, MKV, TS, MPEG-2, mp3, MPEG-4,
 aac, ...) from files, physical media (DVDs, VCD, Audio-CD), TV capture
 cards and many network streaming protocols.

 It can also convert media files, transcode and act as a streaming server
 over unicast or multicast and IPv4 or IPv6. It doesn't need any external
 codec, program or codec pack to work."

gtk_iconcache_dirs="/usr/share/icons/hicolor"
# XXX Add missing deps: gme, telepathy, lua, live555,
# 	libtar (for skins2).
Add_dependency run pulseaudio
Add_dependency run freefont-ttf
Add_dependency run hicolor-icon-theme
Add_dependency run desktop-file-utils

Add_dependency build coreutils
Add_dependency build pkg-config
Add_dependency build videoproto
Add_dependency build libogg-devel
Add_dependency build libvorbis-devel
Add_dependency build SDL-devel
Add_dependency build SDL_image-devel
Add_dependency build x264-devel
Add_dependency build ffmpeg-devel
Add_dependency build xcb-util-devel
Add_dependency build libXxf86vm-devel
Add_dependency build libXinerama-devel
Add_dependency build libXpm-devel
Add_dependency build libXvMC-devel
Add_dependency build libXv-devel
Add_dependency build libmpeg2-devel
Add_dependency build libflac-devel
Add_dependency build fribidi-devel
Add_dependency build freetype-devel
Add_dependency build qt-devel
Add_dependency build avahi-libs-devel
Add_dependency build MesaLib-devel
Add_dependency build libmad-devel
Add_dependency build liba52-devel
Add_dependency build libdca-devel
Add_dependency build libdvbpsi-devel
Add_dependency build libgcrypt-devel
Add_dependency build gtk+-devel
Add_dependency build libnotify-devel
Add_dependency build dbus-glib-devel
Add_dependency build gnutls-devel
Add_dependency build taglib-devel
Add_dependency build libmatroska-devel
Add_dependency build libmpcdec-devel
Add_dependency build libproxy-devel
Add_dependency build libcdio-devel
Add_dependency build libdvdnav-devel
Add_dependency build libsysfs-devel
Add_dependency build libusb-compat-devel
Add_dependency build libmtp-devel
Add_dependency build sqlite-devel
Add_dependency build librsvg-devel
Add_dependency build libtheora-devel
Add_dependency build speex-devel
Add_dependency build pulseaudio-devel
Add_dependency build samba-devel
Add_dependency build libmodplug-devel
Add_dependency build libva-devel
Add_dependency build v4l-utils-devel

pre_configure() {
	# hostname -s is not valid, at least in coreutils!
	sed -i "s|hostname -s|hostname|g" configure
	sed -i "s|/usr/share/fonts/truetype/freefont|/usr/share/fonts/TTF|" \
		modules/misc/freetype.c
}

post_install() {
	# Remove unused stuff
	rm -rf ${DESTDIR}/usr/include
	rm -rf ${DESTDIR}/usr/lib/pkgconfig
	rm -f ${DESTDIR}/usr/bin/vlc-config
	rm -f ${DESTDIR}/usr/share/man/man1/vlc-config.1

	install -d ${DESTDIR}/usr/share/pixmaps
	cd ${DESTDIR}/usr/share/pixmaps && \
		ln -sf ../icons/hicolor/48x48/apps/vlc.png vlc.png
}
