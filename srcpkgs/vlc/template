# Template file for 'vlc'
pkgname=vlc
version=1.0.4
revision=1
distfiles="http://download.videolan.org/pub/videolan/vlc/$version/vlc-$version.tar.bz2"
build_style=gnu_configure
configure_args="--disable-hal --disable-mtp --disable-gme
--disable-telepathy --disable-lua --disable-live555 --disable-pulse
--enable-dvdread --disable-smb --disable-vcdinfo --enable-cddax
--disable-libtar --enable-flac --enable-xvmc --enable-snapshot"
short_desc="VideoLan Client"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=dbff0ba0cd60a4323f85fd8b918f2a4477a11c5a8f628d1b868fb5947e8e9896
long_desc="
 VLC media player is a highly portable multimedia player supporting most
 audio and video formats (H.264, Ogg, DivX, MKV, TS, MPEG-2, mp3, MPEG-4,
 aac, ...) from files, physical media (DVDs, VCD, Audio-CD), TV capture
 cards and many network streaming protocols.

 It can also convert media files, transcode and act as a streaming server
 over unicast or multicast and IPv4 or IPv6. It doesn't need any external
 codec, program or codec pack to work."

# XXX Add missing deps: libmtp, gme, telepathy, lua, live555, pulse
# 	smbclient, libtar (for skins2).

Add_dependency run glibc
Add_dependency run libvorbis
Add_dependency run libogg
Add_dependency run SDL_image
Add_dependency run tiff
Add_dependency run jpeg
Add_dependency run libpng
Add_dependency run zlib
Add_dependency run SDL
Add_dependency run x264
Add_dependency run ffmpeg
Add_dependency run libXxf86vm
Add_dependency run libXinerama
Add_dependency run libSM
Add_dependency run libICE
Add_dependency run libX11
Add_dependency run libXext
Add_dependency run libXvMC
Add_dependency run libXv
Add_dependency run libmpeg2
Add_dependency run libflac
Add_dependency run fribidi
Add_dependency run freetype
Add_dependency run libstdc++
Add_dependency run libgcc
Add_dependency run qt
Add_dependency run avahi-libs
Add_dependency run MesaLib
Add_dependency run libmad
Add_dependency run liba52
Add_dependency run libdca
Add_dependency run udev
Add_dependency run libdvbpsi
Add_dependency run libgcrypt
Add_dependency run libgpg-error
Add_dependency run dbus-libs
Add_dependency run xcb-util
Add_dependency run libxcb
Add_dependency run fontconfig
Add_dependency run libnotify
Add_dependency run gtk+
Add_dependency run dbus-glib
Add_dependency run atk
Add_dependency run glib
Add_dependency run pango
Add_dependency run cairo
Add_dependency run libxml2
Add_dependency run gnutls
Add_dependency run taglib
Add_dependency run libmatroska
Add_dependency run libebml
Add_dependency run libmpcdec
Add_dependency run alsa-lib
Add_dependency run libproxy
Add_dependency run libcddb
Add_dependency run libcdio
Add_dependency run libdvdread
Add_dependency run libdvdnav
Add_dependency build pkg-config
Add_dependency build glibc-devel
Add_dependency build libvorbis-devel
Add_dependency build libogg-devel
Add_dependency build SDL_image-devel
Add_dependency build tiff-devel
Add_dependency build jpeg-devel
Add_dependency build libpng-devel
Add_dependency build zlib-devel
Add_dependency build SDL-devel
Add_dependency build x264-devel
Add_dependency build ffmpeg-devel
Add_dependency build libXxf86vm-devel
Add_dependency build libXinerama-devel
Add_dependency build libSM-devel
Add_dependency build libICE-devel
Add_dependency build libX11-devel
Add_dependency build libXext-devel
Add_dependency build libXvMC-devel
Add_dependency build libXv-devel
Add_dependency build libmpeg2-devel
Add_dependency build libflac-devel
Add_dependency build fribidi-devel
Add_dependency build freetype-devel
Add_dependency build libstdc++-devel
Add_dependency build qt-devel
Add_dependency build avahi-libs-devel
Add_dependency build MesaLib-devel
Add_dependency build libmad-devel
Add_dependency build liba52-devel
Add_dependency build libdca-devel
Add_dependency build udev-devel
Add_dependency build libdvbpsi-devel
Add_dependency build libgcrypt-devel
Add_dependency build libgpg-error-devel
Add_dependency build dbus-devel
Add_dependency build xcb-util-devel
Add_dependency build libxcb-devel
Add_dependency build fontconfig-devel
Add_dependency build libnotify-devel
Add_dependency build gtk+-devel
Add_dependency build dbus-glib-devel
Add_dependency build atk-devel
Add_dependency build glib-devel
Add_dependency build pango-devel
Add_dependency build cairo-devel
Add_dependency build libxml2-devel
Add_dependency build gnutls-devel
Add_dependency build taglib-devel
Add_dependency build libmatroska-devel
Add_dependency build libebml-devel
Add_dependency build libmpcdec-devel
Add_dependency build alsa-lib-devel
Add_dependency build libproxy-devel
Add_dependency build libcddb-devel
Add_dependency build libcdio-devel
Add_dependency build libdvdread-devel
Add_dependency build libdvdnav-devel

pre_configure()
{
	# hostname -s is not valid, at least in coreutils!
	sed -i "s|hostname -s|hostname|g" ${wrksrc}/configure || return 1
}

post_install()
{
	# Remove unused stuff
	rm -rf ${DESTDIR}/usr/include
	rm -rf ${DESTDIR}/usr/lib/pkgconfig
	rm -f ${DESTDIR}/usr/bin/vlc-config
	rm -f ${DESTDIR}/usr/share/man/man1/vlc-config.1

	mkdir -p ${DESTDIR}/usr/share/pixmaps
	cd ${DESTDIR}/usr/share/pixmaps && \
		ln -sf ../vlc/vlc48x48.png vlc.png || return 1
}
