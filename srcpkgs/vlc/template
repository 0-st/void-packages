# Template file for 'vlc'
pkgname=vlc
version=2.0.1
revision=2
build_style=gnu-configure
configure_args="--disable-gme --disable-libtar --disable-jack
--disable-telepathy --disable-lua --disable-live555 --disable-fluidsynth
--enable-dvdread --enable-flac --disable-gnomevfs --disable-portaudio"
# XXX Add missing deps: gme, telepathy, lua, live555, libtar (for skins2).
depends="pulseaudio freefont-ttf hicolor-icon-theme desktop-file-utils"
makedepends="pkg-config videoproto libudev-devel>=183 libpng-devel>=1.5.10 libvorbis-devel SDL_image-devel x264-devel ffmpeg-devel xcb-util-devel libXxf86vm-devel libXinerama-devel libXpm-devel libXvMC-devel libXv-devel libmpeg2-devel libflac-devel fribidi-devel freetype-devel qt-devel avahi-libs-devel MesaLib-devel libmad-devel liba52-devel libdca-devel libdvbpsi-devel libgcrypt-devel gtk+-devel libnotify-devel dbus-glib-devel gnutls-devel taglib-devel libmatroska-devel libmpcdec-devel libproxy-devel libcdio-devel libdvdnav-devel libsysfs-devel libusb-compat-devel libmtp-devel sqlite-devel librsvg-devel libtheora-devel speex-devel pulseaudio-devel samba-devel libmodplug-devel libva-devel v4l-utils-devel libsamplerate-devel"
gtk_iconcache_dirs="/usr/share/icons/hicolor"
short_desc="VideoLan Client"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.videolan.org/vlc/"
license="GPL-2"
distfiles="http://download.videolan.org/pub/videolan/vlc/$version/vlc-$version.tar.xz"
checksum=7f485725c17487a77d70844cbd9acf528360d65cd6ff79d206657920f4fcbf4b
long_desc="
 VLC media player is a highly portable multimedia player supporting most
 audio and video formats (H.264, Ogg, DivX, MKV, TS, MPEG-2, mp3, MPEG-4,
 aac, ...) from files, physical media (DVDs, VCD, Audio-CD), TV capture
 cards and many network streaming protocols.

 It can also convert media files, transcode and act as a streaming server
 over unicast or multicast and IPv4 or IPv6. It doesn't need any external
 codec, program or codec pack to work."

pre_configure() {
	# hostname -s is not valid, at least in coreutils!
	sed -i "s|hostname -s|hostname|g" configure
	sed -i "s|/usr/share/fonts/truetype/freefont|/usr/share/fonts/TTF|" \
		modules/text_renderer/freetype.c
}

post_install() {
	# Remove unused stuff
	rm -rf ${DESTDIR}/usr/include
	rm -rf ${DESTDIR}/usr/lib/pkgconfig
	rm -f ${DESTDIR}/usr/bin/vlc-config
	rm -f ${DESTDIR}/usr/share/man/man1/vlc-config.1
	rm -f ${DESTDIR}/usr/lib/vlc/plugins/plugins.dat

	install -d ${DESTDIR}/usr/share/pixmaps
	cd ${DESTDIR}/usr/share/pixmaps && \
		ln -sf ../icons/hicolor/48x48/apps/vlc.png vlc.png
}
