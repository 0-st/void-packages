# Template build file for 'sudo'.
pkgname=sudo
version=1.7.2p2
revision=2
distfiles="http://www.courtesan.com/sudo/dist/$pkgname-$version.tar.gz"
build_style=gnu_configure
configure_args="--with-ignore-dot -with-all-insults --with-env-editor
--enable-shell-sets-home --enable-noargs-shell --enable-pam
--disable-root-sudo --with-logfac=auth --without-sendmail
--disable-root-mailer --disable-setresuid"
short_desc="Allow others to run commands as root"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=3d93aa2d52873b1fc82dc6dd64f1046e4636735f55d9ca7861ef02235b7c7e45
long_desc="
 Sudo is a program designed to allow a sysadmin to give limited root
 privileges to users and log root activity. The basic philosophy is to
 give as few privileges as possible but still allow people to get their
 work done."

conf_files="/etc/pam.d/sudo /etc/sudoers"
nostrip=yes

Add_dependency run glibc
Add_dependency run pam
Add_dependency build pam-devel

post_install()
{
	install -d $DESTDIR/etc/pam.d
	cat > $DESTDIR/etc/pam.d/sudo <<_EOF
auth	required	pam_unix.so
account	required	pam_unix.so
session	optional	pam_mail.so	dir=/var/mail standard
session	optional	pam_xauth.so
session	required	pam_env.so
session	required	pam_unix.so
_EOF
	chmod 644 $DESTDIR/etc/pam.d/sudo
}
