# Template build file for 'sudo'.
pkgname=sudo
version=1.8.4p2
distfiles="http://www.courtesan.com/sudo/dist/$pkgname-$version.tar.gz"
build_style=gnu-configure
configure_args="--with-ignore-dot -with-all-insults --with-env-editor
--enable-shell-sets-home --enable-noargs-shell --without-sendmail
--disable-root-sudo --with-logfac=auth --disable-root-mailer"
short_desc="Allow others to run commands as root"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.gratisoft.us/sudo/"
license="ISC, BSD, zlib"
checksum=b1310b8548db5ea92f3063011c0fe6e843a1f95f548a4aeae54bcc2fdfea88a9
long_desc="
 Sudo is a program designed to allow a sysadmin to give limited root
 privileges to users and log root activity. The basic philosophy is to
 give as few privileges as possible but still allow people to get their
 work done."

conf_files="/etc/pam.d/sudo /etc/sudoers"
nostrip=yes

# Build PIE binaries by default.
CFLAGS="-fPIE"
LDFLAGS="-pie"
CPPFLAGS="-D_FORTIFY_SOURCE=2"

Add_dependency build zlib-devel
Add_dependency build pam-devel

post_install() {
	vinstall ${FILESDIR}/sudo.pam 644 etc/pam.d sudo
	vmove usr/share/doc/sudo/LICENSE usr/share/licenses/sudo
	# remove unused stuff.
	rm -rf ${DESTDIR}/usr/share/doc
	rm -rf ${DESTDIR}/usr/include
}
