# Template file for 'go'
pkgname=go
version=r58
revision=1
build_style=custom-install
build_wrksrc=go-release
short_desc="The Go Programming Language"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://golang.org/"
license="BSD"
long_desc="
 The Go programming language is an open source project to make programmers
 more productive. Go is expressive, concise, clean, and efficient. Its
 concurrency mechanisms make it easy to write programs that get the most out
 of multicore and networked machines, while its novel type system enables
 flexible and modular program construction. Go compiles quickly to machine
 code yet has the convenience of garbage collection and the power of run-time
 reflection. It's a fast, statically typed, compiled language that feels like
 a dynamically typed, interpreted language.
"

nofetch=yes
noextract=yes
nostrip=yes

Add_dependency run make
Add_dependency run glibc

Add_dependency build mercurial
Add_dependency build coreutils
Add_dependency build ed
Add_dependency build bison
Add_dependency build gawk
Add_dependency build glibc-devel

do_fetch()
{
	local url="https://go.googlecode.com/hg"
	cd $wrksrc
	hg clone -u ${version} ${url} ${build_wrksrc}
}

do_build()
{
	cd ${wrksrc}/${build_wrksrc}/src
	GOROOT="${wrksrc}/${build_wrksrc}"
	GOROOT_FINAL="/opt/go/"
	bash ./make.bash
	hg --config extensions.purge= purge . --all
}

do_install() 
{
	cd ${wrksrc}/${build_wrksrc}
	vmkdir opt/go 755
	for i in bin doc misc src lib include pkg;do
		vcopy $i opt/go
	done
	vinstall ${FILESDIR}/go.sh 644 etc/profile.d
}
