# Template file for 'galculator'

pkgname="galculator-gtk3"
version="2.1.3"
revision=2
wrksrc="${pkgname%-*}-${version}"
build_style=gnu-configure
hostmakedepends="intltool pkg-config"
makedepends="gtk+-devel gtk+3-devel"
short_desc="GTK+ based scientific calculator (GTK+3)"
maintainer="Aaditya Bagga <abchk1234@gmail.com>"
license="GPL-2"
homepage="galculator.sourceforge.net"
distfiles="${SOURCEFORGE_SITE}/${pkgname%-*}/${pkgname%-*}-${version}.tar.bz2"
checksum="91ac62d6d74da910cb79c68f7bf3f4505ac0efe51091150c4ea54fe1c1306235"

provides="galculator-${version}_${revision}"
replaces="galculator-gtk2>=0"

pre_configure() {
	mkdir -p gtk2
	mv * gtk2 || true
	cp -a gtk2 gtk3
}

do_configure() {
	# GTK+2
	cd ${wrksrc}/gtk2
	./configure ${configure_args} --disable-gtk3
	# GTK+3
	cd ${wrksrc}/gtk3
	./configure ${configure_args} --enable-gtk3
}

do_build() {
	make ${makejobs} -C gtk2
	make ${makejobs} -C gtk3
}

do_install() {
	make DESTDIR=${DESTDIR} -C ${wrksrc}/gtk3 install
}

galculator-gtk2_package() {
	short_desc="${short_desc/GTK+3/GTK+2}"
	provides="galculator-${version}_${revision}"
	replaces="galculator-gtk3>=0"
	pkg_install() {
		make DESTDIR=${PKGDESTDIR} -C ${wrksrc}/gtk2 install
	}
}
