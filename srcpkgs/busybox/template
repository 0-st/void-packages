# Build template for 'busybox'.
pkgname=busybox
version=1.19.2
revision=3
homepage="http://www.busybox.net"
distfiles="${homepage}/downloads/busybox-$version.tar.bz2"
short_desc="The Swiss Army Knife of Embedded Linux"
maintainer="Juan RP <xtraeme@gmail.com>"
license="GPL-2"
checksum=ea7ec9b6df70b8c528f4a2b6300e9913431c7223308fb08dfafa7508d75a0cb9
long_desc="
 BusyBox combines tiny versions of many common UNIX utilities into a single
 small executable. It provides replacements for most of the utilities you
 usually find in GNU fileutils, shellutils, etc. The utilities in BusyBox
 generally have fewer options than their full-featured GNU cousins; however,
 the options that are included provide the expected functionality and behave
 very much like their GNU counterparts. BusyBox provides a fairly complete
 environment for any small or embedded system."

bootstrap=yes

if [ -n "$BOOTSTRAP_PKG_REBUILD" ]; then
	Add_dependency build coreutils
	Add_dependency build perl ">=0"
fi

do_build()
{
	cp -f ${FILESDIR}/dotconfig .config
	sed -i "s|pod2|/usr/lib/perl5/core_perl/bin/pod2|g" Makefile.custom
	make ${makejobs}
}

do_install()
{
	vinstall busybox 755 bin
	vinstall docs/busybox.1 644 usr/share/man/man1
	# Create /usr/bin/vi symlink for base.
	vmkdir usr/bin
	cd ${DESTDIR}/usr/bin && ln -sf ../../bin/busybox vi
}
