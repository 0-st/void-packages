# Build template for 'busybox'.
pkgname=busybox
version=1.18.2
distfiles="http://www.busybox.net/downloads/busybox-$version.tar.bz2"
build_style=custom-install
short_desc="The Swiss Army Knife of Embedded Linux"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=aa7e1cec8cd9c7f4e56098b9e4bb2ab5d593d5a35f766ad9e6a312289bf57080
long_desc="
 BusyBox combines tiny versions of many common UNIX utilities into a single
 small executable. It provides replacements for most of the utilities you
 usually find in GNU fileutils, shellutils, etc. The utilities in BusyBox
 generally have fewer options than their full-featured GNU cousins; however,
 the options that are included provide the expected functionality and behave
 very much like their GNU counterparts. BusyBox provides a fairly complete
 environment for any small or embedded system."

base_chroot=yes
replaces="busybox-initramfs>=0"
Add_dependency run glibc

do_build()
{
	cp -f ${FILESDIR}/dotconfig .config
	make ${makejobs}
}

do_install()
{
	# XXX How to disable the fucking applets symlinks??!!!
	install -d ${DESTDIR}/bin
	make CONFIG_PREFIX=${DESTDIR}/usr/lib/busybox install
	mv ${DESTDIR}/usr/lib/busybox/bin/busybox ${DESTDIR}/bin
	rm -rf ${DESTDIR}/usr
}
