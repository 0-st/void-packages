From b5d141e28c5387834f8a57cf0d7eb1fc89697ca4 Mon Sep 17 00:00:00 2001
From: Juan RP <xtraeme@gmail.com>
Date: Wed, 13 Mar 2013 22:08:13 +0100
Subject: [PATCH] When checking for obsolete files ignore unexistent files.

---
 NEWS                         | 7 ++++++-
 lib/package_find_obsoletes.c | 6 ++++--
 2 files changed, 10 insertions(+), 3 deletions(-)

diff --git a/lib/package_find_obsoletes.c b/lib/package_find_obsoletes.c
index 874b137..51d6ddb 100644
--- lib/package_find_obsoletes.c
+++ lib/package_find_obsoletes.c
@@ -104,8 +104,10 @@ xbps_find_pkg_obsoletes(struct xbps_handle *xhp,
 	for (i = 0; i < prop_array_count(instfiles); i++) {
 		found = false;
 		obj = prop_array_get(instfiles, i);
-		assert(prop_object_type(obj) == PROP_TYPE_DICTIONARY);
-
+		if (prop_object_type(obj) != PROP_TYPE_DICTIONARY) {
+			/* ignore unexistent files */
+			continue;
+		}
 		oldstr = prop_dictionary_get(obj, "file");
 		if (oldstr == NULL)
 			continue;
-- 
1.8.1.3

