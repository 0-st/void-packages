# Template file for 'xbps'
pkgname=xbps
version=0.20
revision=10
build_style=configure
configure_args="--prefix=/ --exec-prefix=/usr --sbindir=/usr/sbin
 --enable-static --enable-debug"
depends="xbps-triggers"
makedepends="which pkg-config proplib-devel>=0.6.2 openssl-devel
 libfetch-devel libarchive-devel>=3.1.2 confuse-devel"
conf_files="/etc/xbps/xbps.conf"
subpackages="libxbps libxbps-devel xbps-static"
replaces="xbps>=0"
short_desc="The XBPS package system utilities"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://code.google.com/p/xbps"
license="Simplified BSD"
distfiles="http://xbps.googlecode.com/files/xbps-$version.tar.gz"
checksum=91e0ae3c6cf807e1f66e45d84c1913d9d87c0eb201ae9c07bc3b4425beba401f

crossmakedepends="proplib-devel>=0.6.2 openssl-devel libfetch-devel
 libarchive-devel>=3.1.2 confuse-devel"

if [ -n "$XBPS_CROSS_TRIPLET" ]; then
	subpackages="libxbps libxbps-devel xbps-static"
	makedepends="which pkg-config confuse-devel openssl-devel libarchive-devel>=3.1.2"

pre_build() {
	sed -i "s|-L\$(LIBDIR)|-L/usr/${XBPS_CROSS_TRIPLET}/lib|g" config.mk
}

else
	configure_args="${configure_args} --enable-tests"
	makedepends="${makedepends} atf-devel>=0.16"
	subpackages="${subpackages} xbps-tests"
fi
