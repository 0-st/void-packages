# Template file for 'systemd'
pkgname=systemd
version=29
distfiles="http://www.freedesktop.org/software/$pkgname/$pkgname-$version.tar.bz2"
build_style=gnu_configure
configure_args="--with-distro=gentoo --with-rootdir= --localstatedir=/var
--with-pamlibdir=/lib/security --disable-selinux"
short_desc="systemd is a system and service manager for Linux"
maintainer="Mike Rosset <mike.rosset@gmail.com>"
homepage="http://www.freedesktop.org/wiki/Software/systemd"
license="GPL-2"
checksum=c41153c3ebab9e25b16fa1670946ce6dfdd1515608a37eedd80d2bbe46629971
long_desc="
 systemd is a system and service manager for Linux, compatible with SysV and LSB
 init scripts. systemd provides aggressive parallelization capabilities, uses 
 socket and D-Bus activation for starting services, offers on-demand starting of 
 daemons, keeps track of processes using Linux cgroups, supports snapshotting and 
 restoring of the system state, maintains mount and automount points and 
 implements an elaborate transactional dependency-based service control logic. 
 It can work as a drop-in replacement for sysvinit."

subpackages="systemd-admin systemd-gnome-passwd-agent systemd-devel"
conf_files="/etc/systemd/system.conf"

Add_dependency run glibc
Add_dependency run libudev
Add_dependency run tcp_wrappers-libs
Add_dependency run pam
Add_dependency run libcap
Add_dependency run dbus-libs

Add_dependency build m4
Add_dependency build pkg-config
Add_dependency build libudev-devel
Add_dependency build pam-devel
Add_dependency build dbus-devel
Add_dependency build libcap-devel
Add_dependency build tcp_wrappers-devel
Add_dependency build glib-devel
Add_dependency build gtk+-devel
Add_dependency build libnotify-devel

pre_install()
{
	install -d ${DESTDIR}
	ln -sf /lib ${DESTDIR}/lib64
}

post_install()
{
	rm -f ${DESTDIR}/lib64
	cd ${DESTDIR}/usr/share/man/man8
	for manpage in telinit halt reboot poweroff runlevel shutdown; do
		mv ${manpage}.8 ${manpage}-systemd.8
	done
	mv ${DESTDIR}/usr/share/pkgconfig ${DESTDIR}/usr/lib
}
