# Template file for 'plymouth'
pkgname=plymouth
version=0.8.3
revision=1
patch_args="-Np1"
homepage="http://cgit.freedesktop.org/plymouth"
distfiles="${homepage}/snapshot/$pkgname-$version.tar.bz2"
build_style=gnu_configure
configure_args="--enable-gdm-transition
--with-release-file=/etc/os-release --disable-static
--localstatedir=/var --enable-pango --enable-tracing --disable-tests
--with-system-root-install --without-rhgb-compat-link
--with-logo=/usr/share/plymouth/xbps-logo.png
--with-background-color=0xffffff"
short_desc="Graphical boot animation and logger"
maintainer="Juan RP <xtraeme@gmail.com>"
license="GPL-2"
checksum=2e51abbc087228f7910302334755d0190fc9e923eae9992150adb0f6cccc9077
long_desc="
 Plymouth is an application that runs very early in the boot process
 (even before the root filesystem is mounted!) that provides a graphical
 boot animation while the boot process happens in the background."

subpackages="libplymouth ${pkgname}-x11 ${pkgname}-drm ${pkgname}-devel"
conf_files="/etc/plymouth/plymouthd.conf"

Add_dependency run glibc
Add_dependency run glib
Add_dependency run pango
Add_dependency run cairo
Add_dependency run libpng
Add_dependency run libplymouth

Add_dependency build automake
Add_dependency build pkg-config
Add_dependency build gtk+-devel
Add_dependency build libdrm-devel

pre_configure() {
	autoreconf -fi
}

post_install() {
	rm -f ${DESTDIR}/usr/libexec/plymouth/*
	vinstall ${FILESDIR}/plymouth-update-initrd 755 usr/libexec/plymouth

	# initramfs-tools hook
	vinstall ${FILESDIR}/plymouth.hook 755 \
		usr/share/initramfs-tools/hooks plymouth
	vinstall ${FILESDIR}/plymouth.init-bottom 755 \
		usr/share/initramfs-tools/scripts/init-bottom plymouth
	vinstall ${FILESDIR}/plymouth.init-premount 755 \
		usr/share/initramfs-tools/scripts/init-premount plymouth
	vinstall ${FILESDIR}/xbps-logo.png 644 usr/share/plymouth
}
