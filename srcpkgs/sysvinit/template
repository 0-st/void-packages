# Template file for 'sysvinit'
pkgname=sysvinit
version=2.86
revision=1
distfiles="
ftp://ftp.cistron.nl/pub/people/miquels/$pkgname/$pkgname-$version.tar.gz"
build_style=custom-install
short_desc="Linux System V Init"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=035f98fae17d9cff002993c564ccc83dc4ed136127172caeff872b6abdb679d8
long_desc="
 System V style init programs for booting a GNU/Linux system."

Add_dependency full glibc
Add_dependency full shadow
Add_dependency full util-linux-ng
Add_dependency full coreutils
Add_dependency full gawk

do_build()
{
	cd ${wrksrc} || return 1
	sed -i -e 's/utmpdump wall/utmpdump/' \
		-e 's/mountpoint.1 wall.1/mountpoint.1/' src/Makefile
	sed -i 's/\(.*\)\(Sending processes\)\(.*\)/\1\2 started by init\3/' \
		src/init.c
	make -C src || return 1
}

do_install()
{
	cd ${wrksrc} || return 1

	install -d ${DESTDIR}/bin ${DESTDIR}/sbin \
		${DESTDIR}/usr/bin ${DESTDIR}/usr/include \
		${DESTDIR}/usr/share/man/man1 \
		${DESTDIR}/usr/share/man/man5 \
		${DESTDIR}/usr/share/man/man8

	make -C src MANDIR=/usr/share/man ROOT=${DESTDIR} install
	# Remove unneeded stuff
	rm -rf ${DESTDIR}/usr/include
}
