pkgname=cbp2make
version=1.4.7
revision=1
wrksrc=$pkgname-stl-rev${version//./}-all
hostmakedepends="doxygen p7zip"
short_desc="Makefile generation tool for Code::Blocks IDE"
maintainer="Michael Aldridge <aldridge.mac@gmail.com>"
license="GPL-3"
homepage="http://sourceforge.net/projects/cbp2make/"
distfiles="${SOURCEFORGE_SITE}/$pkgname/cbp2make-stl-rev${version//./}-all.tar.7z"
checksum=1b211abb8de00dc3048fccad6ebd076ab03dcb9f672cdff379de33a1346ed129

case "$XBPS_TARGET_MACHINE" in
	*-musl) broken="Build fails on muslc";;
esac

do_extract() {
	7z x ${XBPS_SRCDISTDIR}/$pkgname-$version/$pkgname-stl-rev${version//./}-all.tar.7z -o$XBPS_BUILDDIR
}

pre_build() {
	cp cbp2make.cbp.mak.unix Makefile
}

do_build() {
	make release CC=$CC CXX=$CXX LD=$CXX
}

do_install() {
	vbin bin/Release/cbp2make
}
