# Template file for 'bluez'
pkgname=bluez
version=4.99
revision=2
distfiles="${KERNEL_SITE}/bluetooth/$pkgname-$version.tar.xz"
build_style=gnu-configure
configure_args="--libexecdir=/lib --enable-gstreamer --enable-dund
--enable-alsa --enable-usb --enable-tools --enable-bccmd
--enable-hid2hci --enable-dfutool --enable-hidd --enable-pand
--enable-cups --enable-capng --enable-pnat --enable-wiimote
--with-systemdsystemunitdir=/lib/systemd/system --disable-test"
makedepends="automake>=1.11.3_1 pkg-config flex libudev-devel readline-devel gst-plugins-base-devel alsa-lib-devel dbus-devel glib-devel libusb-compat-devel libcap-ng-devel libsndfile-devel cups-devel"
short_desc="Bluetooth tools and daemons"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.bluez.org/"
license="GPL-2"
checksum=41889a91a5516eec26c4e59095ceea076de158b1ac38fd0ede9034596f511d3b
long_desc="
 This package contains tools and system daemons for using Bluetooth devices.

 BlueZ is the official Linux Bluetooth protocol stack. It is an Open Source
 project distributed under GNU General Public License (GPL)."

make_dirs="/var/lib/bluetooth 0755 root root"
conf_files="
/etc/bluetooth/main.conf
/etc/bluetooth/rfcomm.conf
/etc/bluetooth/network.conf
/etc/bluetooth/input.conf
/etc/bluetooth/audio.conf
/etc/bluetooth/serial.conf"

subpackages="$pkgname-alsa $pkgname-compat $pkgname-gstreamer libbluetooth"
subpackages="$subpackages libbluetooth-devel"


pre_configure() {
	autoreconf -fi
}

post_install() {
	for f in network input audio serial; do
		vinstall ${f}/${f}.conf 644 etc/bluetooth
	done
	vinstall scripts/bluetooth_serial 755 lib/udev
	for f in simple-agent test-device test-input; do
		vinstall test/${f} 755 usr/bin bluez-${f}
	done
	# systemd takes care of bluetoothd initialization.
	rm -f ${DESTDIR}/lib/udev/rules.d/97-bluetooth.rules
}
