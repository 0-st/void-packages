# Template file for 'bluez'
pkgname=bluez
version=4.65
distfiles="${KERNEL_SITE}/bluetooth/$pkgname-$version.tar.bz2"
build_style=gnu_configure
configure_args="--localstatedir=/var --libexecdir=/lib --enable-gstreamer
 --enable-alsa --enable-usb --enable-netlink --enable-tools --enable-bccmd
 --enable-hid2hci --enable-dfutool --enable-hidd --enable-pand --enable-dund
 --disable-cups --enable-configfiles --enable-capng --enable-pnat"
short_desc="Bluetooth tools and daemons"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=6b86a6e0a6c53d9815e33a53b252f2579201c83546008e3dd81017c2cb7b5c6e
long_desc="
 This package contains tools and system daemons for using Bluetooth devices.

 BlueZ is the official Linux Bluetooth protocol stack. It is an Open Source
 project distributed under GNU General Public License (GPL)."

conf_files="
/etc/conf.d/bluetooth
/etc/bluetooth/audio.conf
/etc/bluetooth/input.conf
/etc/bluetooth/main.conf
/etc/bluetooth/network.conf
/etc/bluetooth/rfcomm.conf"
openrc_services="bluetooth default true"

subpackages="$pkgname-alsa $pkgname-compat $pkgname-gstreamer libbluetooth"
subpackages="$subpackages libbluetooth-devel"

Add_dependency run glibc
Add_dependency run dbus-libs
Add_dependency run glib
Add_dependency run libnl
Add_dependency run libusb-compat
Add_dependency run libcap-ng
Add_dependency run libbluetooth
Add_dependency build pkg-config
Add_dependency build flex
Add_dependency build gst-plugins-base-devel
Add_dependency build alsa-lib-devel
Add_dependency build dbus-devel
Add_dependency build glib-devel
Add_dependency build libnl-devel
Add_dependency build libusb-compat-devel
Add_dependency build libcap-ng-devel
Add_dependency build udev # This is for udev rules location

post_install()
{
	cd ${wrksrc} || return 1
	install -d ${DESTDIR}/lib/udev/rules.d
	install -m644 network/network.conf input/input.conf audio/audio.conf \
		${DESTDIR}/etc/bluetooth || return 1
	install -m755 scripts/bluetooth_serial ${DESTDIR}/lib/udev || return 1
	install -m755 test/simple-agent \
		${DESTDIR}/usr/bin/bluez-simple-agent || return 1
	install -d ${DESTDIR}/etc/init.d ${DESTDIR}/etc/conf.d || return 1
	install -m755 ${FILESDIR}/bluetooth.rc \
		${DESTDIR}/etc/init.d/bluetooth || return 1
	install -m644 ${FILESDIR}/bluetooth.confd \
		${DESTDIR}/etc/conf.d/bluetooth || return 1
}	
