# Template file for 'webkit-gtk3'
pkgname=webkit-gtk3
version=1.6.1
wrksrc=webkit-${version}
homepage="http://webkitgtk.org/"
license="LGPL-2.1, Simplified BSD (2 clause)"
distfiles="${homepage}/webkit-${version}.tar.gz"
short_desc="GTK+3 port of the WebKit browser engine"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=05b09d851a04597d50fdca71ed8b09f5a0337d696b141a435255ae2095e140ad
long_desc="
 WebKit is an open source web browser engine. WebKit is also the name of
 the Mac OS X system framework version of the engine that's used by
 Safari, Dashboard, Mail, and many other OS X applications. WebKit's HTML
 and JavaScript code began as a branch of the KHTML and KJS libraries
 from KDE.

 This is the GTK3+ port of the engine."

subpackages="webkit-gtk webkit-gtk-devel $pkgname-devel"

Add_dependency run libgcc
Add_dependency run glibc
Add_dependency run libstdc++
Add_dependency run glib
Add_dependency run atk
Add_dependency run pango
Add_dependency run cairo
Add_dependency run jpeg
Add_dependency run libxslt
Add_dependency run zlib
Add_dependency run libxml2
Add_dependency run freetype
Add_dependency run fontconfig
Add_dependency run libpng
Add_dependency run sqlite
Add_dependency run icu-libs
Add_dependency run libX11
Add_dependency run libXt
Add_dependency run gdk-pixbuf
Add_dependency run gtk+3
Add_dependency run gstreamer
Add_dependency run gst-plugins-base
Add_dependency run enchant
Add_dependency run libsoup
Add_dependency run libXrender

Add_dependency build pkg-config
Add_dependency build intltool
Add_dependency build which
Add_dependency build perl	">=0"
Add_dependency build gperf
Add_dependency build flex
Add_dependency build gobject-introspection
Add_dependency build enchant-devel
Add_dependency build gtk+-devel
Add_dependency build gtk+3-devel
Add_dependency build gst-plugins-base-devel
Add_dependency build libsoup-devel
Add_dependency build libxslt-devel
Add_dependency build sqlite-devel
Add_dependency build icu-devel

do_configure()
{
	local args="--enable-video --enable-jit --enable-3d-transforms \
		--with-font-backend=freetype --enable-introspection \
		--with-unicode-backend=icu --disable-schemas-compile \
		${CONFIGURE_SHARED_ARGS}"

	for ver in 2 3; do
		[ ! -d ${wrksrc}/build-gtk${ver} ] && \
			mkdir ${wrksrc}/build-gtk${ver}
		cd ${wrksrc}/build-gtk${ver}
		../configure ${args} --with-gtk=${ver}.0
	done
}

do_build()
{
	for ver in 2 3; do
		msg_normal "Building GTK+${ver} version...\n"
		cd ${wrksrc}/build-gtk${ver}
		make ${makejobs}
	done
}

do_install()
{
	for ver in 2 3; do
		msg_normal "Installing GTK+${ver} version...\n"
		cd ${wrksrc}/build-gtk${ver}
		make DESTDIR=${DESTDIR} install
	done
}
