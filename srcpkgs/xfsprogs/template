# Template file for 'xfsprogs'
pkgname=xfsprogs
version=3.1.7
revision=1
homepage="http://oss.sgi.com/projects/xfs/"
distfiles="http://ftp.archlinux.org/other/xfsprogs/$pkgname-$version.tar.gz"
short_desc="Utilities for managing the XFS filesystem"
maintainer="Juan RP <xtraeme@gmail.com>"
license="LGPL-2.1"
checksum=e150914210ac5fd29c098ef0fd94bdec51d2fb231cf9faa765c16ec6d75c8eaa
long_desc="
 A set of commands to use the XFS filesystem, including mkfs.xfs.

 XFS is a high performance journaling filesystem which originated on the
 SGI IRIX platform. It is completely multi-threaded, can support large files
 and large filesystems, extended attributes, variable block sizes, is extent
 based, and makes extensive use of Btrees (directories, extents, free space)
 to aid both performance and scalability."

replaces="xfsprogs-libs>=0"

disable_parallel_build=yes
subpackages="$pkgname-devel"

Add_dependency build libuuid-devel
Add_dependency build libblkid-devel
Add_dependency build readline-devel

do_build() {
	export DEBUG=-DNDEBUG
	./configure ${CONFIGURE_SHARED_ARGS} \
		--enable-readline=yes --enable-blkid=yes --enable-lib64=no
	make ${makejobs}
}

do_install() {
	make DIST_ROOT=${DESTDIR} install install-dev
	# Remove unneeded stuff
	rm -rf ${DESTDIR}/usr/share/doc
	rm -f ${DESTDIR}/usr/share/man/man5/proj*
	rm -f ${DESTDIR}/lib/*.{a,la}
	rm -f ${DESTDIR}/usr/lib/*.so
	# Move stuff to /usr.
	vmove "sbin/*" usr/sbin
	vmove "lib/*" usr/lib
}
