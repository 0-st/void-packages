# Template build file for 'xorg-server'.
pkgname=xorg-server
version=1.11.0
distfiles="${XORG_SITE}/xserver/$pkgname-$version.tar.bz2"
build_style=gnu_configure
configure_args="--enable-ipv6
--enable-glx-tls --localstatedir=/var --disable-static --disable-config-hal
--disable-config-dbus --enable-config-udev --sysconfdir=/etc/X11
--with-xkb-path=/usr/share/X11/xkb --with-xkb-output=/var/lib/xkb
--with-fontrootdir=/usr/share/fonts/X11 --with-sha1=libcrypto
--disable-dmx --disable-xfree86-utils --enable-dga"
short_desc="Modular X11 server from modular X.org"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://xorg.freedesktop.org"
license="MIT/X11, BSD"
checksum=9feb62c2972644fadaf94eda02c1d0009ec7089abd47086e5d9dcb4625338453
long_desc="
 The X11 server from the modularized source tree of X.org."

conf_files="/etc/udev/rules.d/75-x11-input.rules"
subpackages="$pkgname-devel"

Add_dependency run glibc
Add_dependency run libudev
Add_dependency run libssl
Add_dependency run libXext
Add_dependency run libX11
Add_dependency run libpciaccess
Add_dependency run libXfont		">=1.4.2"
Add_dependency run libXau
Add_dependency run pixman
Add_dependency run libXdmcp
Add_dependency run libdrm
# Not a direct dependency, but it's required for DRI.
Add_dependency run MesaLib

Add_dependency build pkg-config
Add_dependency build perl		">=0"
Add_dependency build flex
Add_dependency build glproto		">=1.4.14"
Add_dependency build xproto		">=7.0.22"
Add_dependency build dri2proto		">=2.1"
Add_dependency build xf86driproto
Add_dependency build randrproto
Add_dependency build videoproto
Add_dependency build compositeproto
Add_dependency build scrnsaverproto
Add_dependency build resourceproto
Add_dependency build xineramaproto
Add_dependency build libudev-devel
Add_dependency build openssl-devel
Add_dependency build libdmx-devel
Add_dependency build libXext-devel
Add_dependency build libX11-devel
Add_dependency build libpciaccess-devel
Add_dependency build libXfont-devel
Add_dependency build libXau-devel
Add_dependency build pixman-devel
Add_dependency build libXdmcp-devel
Add_dependency build libXmu-devel
Add_dependency build libXrender-devel
Add_dependency build libXfixes-devel
Add_dependency build libXi-devel
Add_dependency build libXaw-devel
Add_dependency build libXt-devel
Add_dependency build libSM-devel
Add_dependency build libICE-devel
Add_dependency build libXpm-devel
Add_dependency build libdrm-devel
Add_dependency build libXtst-devel
Add_dependency build libXres-devel
Add_dependency build MesaLib-devel
Add_dependency build libxkbui-devel
Add_dependency build libxkbfile-devel
Add_dependency build libXxf86dga-devel

Add_dependency full xkeyboard-config

post_install()
{
	vinstall ${FILESDIR}/x11-input.rules 644 \
		etc/udev/rules.d 75-x11-input.rules
	vinstall ${FILESDIR}/11-quirks.conf 644 etc/X11/xorg.conf.d
	vinstall COPYING 644 usr/share/licenses/${pkgname}
}
