# Template build file for 'xorg-server'.
pkgname=xorg-server
version=1.7.4
distfiles="${XORG_SITE}/xserver/$pkgname-$version.tar.bz2"
build_style=gnu_configure
configure_args="--with-dri-driver-path=/usr/lib/dri
 --enable-glx-tls --localstatedir=/var --disable-static
 --enable-config-dbus --sysconfdir=/etc/X11 --enable-config-hal
 --enable-install-setuid --with-xkb-path=/usr/share/X11/xkb
 --with-xkb-output=/var/lib/xkb"
short_desc="Modular X11 server from modular X.org"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=b8ec11b3f2c6f84c21e8cd9804672ba6e27fda3e913d58dd947205ea253e33f8
long_desc="
 The X.org X11 Server from the modularized source tree of X.org X11."

conf_files="/etc/dbus-1/system.d/xorg-server.conf"
subpackages="$pkgname-devel"

Add_dependency run glibc
Add_dependency build dri2proto	">=2.1"
Add_dependency build xf86driproto
Add_dependency build perl
Add_dependency build pkg-config
Add_dependency build flex
Add_dependency full hal

_deps="openssl dbus libpciaccess pixman libdmx libICE libSM libX11 libXau"
_deps="${_deps} libXaw libXdmcp libXext libXfixes libXfont libXi libXmu"
_deps="${_deps} libXpm libXrender libXt"
for _dep_ in ${_deps}; do
	Add_dependency run	${_dep_}
	Add_dependency build	${_dep_}-devel
done

pre_configure()
{
	# Fix dbus config path
	sed -i -e 's/\$(sysconfdir)/\/etc/' $wrksrc/config/Makefile.*
}

post_install()
{
	rm -rf ${DESTDIR}/var/log
}
