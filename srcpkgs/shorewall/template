# Template file for 'shorewall'
pkgname=shorewall
version=4.5.21.4
revision=2
_disturl="http://www.shorewall.net/pub/${pkgname}/4.5/${pkgname}-4.5.21"
distfiles="
 ${_disturl}/${pkgname}-${version}.tar.bz2
 ${_disturl}/${pkgname}6-${version}.tar.bz2
 ${_disturl}/${pkgname}-core-${version}.tar.bz2"
checksum="
 297aa07e793e40b8c2a7ce45789e865b54bd53166303aa0baddd937894d50cc9
 32c76e983c3f5c559a9de29cecfa9e918ed3f242d7bd4c1d49c4dfe5fff49a5f
 f4a0c6b4789be28ac20ea3a0b8136f9aab72ad1399afa84714097fc6ad66dd1c"
maintainer="Steven R <strob AT styez DOT com>"
homepage="http://www.shorewall.net/"
license="GPL"
short_desc="An iptables-based firewall for Linux systems"

create_wrksrc=yes

do_build(){
	for product in ${pkgname}{-core,6,}-${version}; do
		cd ${wrksrc}/${product}
		./configure HOST=archlinux SBINDIR=/usr/bin
	done
}

do_install() {
	:
}

shorewall_package() {
	noarch="yes"
	depends="shorewall-core perl"
	systemd_services="${pkgname}.service off"
	make_dirs="/var/lib/${pkgname} 0755 0 0"
	pkg_install() {
		cd ${wrksrc}/${pkgname}-${version}
		DESTDIR="${PKGDESTDIR}" ./install.sh
		vmkdir usr/share/doc/${pkgname}
		cp -r Samples ${PKGDESTDIR}/usr/share/doc/${pkgname}
	}
	for f in ${PKGDESTDIR}/etc/${pkgname}/*; do
		conf_files+="${f##${PKGDESTDIR}} "
	done
}

shorewall-core_package() {
	noarch="yes"
	depends="iptables iproute2"
	short_desc+=" - Core Shorewall libraries"
	pkg_install() {
		cd ${wrksrc}/${pkgname}-${version}
		DESTDIR="${PKGDESTDIR}" ./install.sh
	}
}

shorewall6_package() {
	noarch="yes"
	depends="shorewall"
	short_desc+=" - IPv6 support"
	systemd_services="${pkgname}.service off"
	make_dirs="/var/lib/${pkgname} 0755 0 0"
	pkg_install() {
		cd ${wrksrc}/${pkgname}-${version}
		DESTDIR="${PKGDESTDIR}" ./install.sh
	}
	for f in ${PKGDESTDIR}/etc/${pkgname}/*; do
		conf_files+="${f##${PKGDESTDIR}} "
	done
}
