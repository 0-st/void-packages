# Template file for 'rsyslog'
pkgname=rsyslog
version=4.6.1
distfiles="http://download.rsyslog.com/$pkgname/$pkgname-$version.tar.gz"
build_style=gnu_configure
configure_args="--enable-gnutls --enable-mysql --enable-pgsql"
short_desc="An Enhanced multi-threaded syslog daemon"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=dbfa6a0472c8e4a08fe2c28b0c4f698e7fc2fafdd06092c06389d3dc364e8f2c
long_desc="
 Rsyslog is an enhanced multi-threaded syslogd supporting, among
 others, MySQL, PgSQL, syslog/tcp, RFC 3195, permitted sender lists,
 filtering on any message part, and fine grain output format control."

subpackages="$pkgname-gnutls $pkgname-mysql $pkgname-postgresql"
conf_files="/etc/rsyslog.conf /etc/conf.d/rsyslogd"
openrc_services="rsyslogd default"

Add_dependency run glibc
Add_dependency run zlib
Add_dependency build pkg-config
Add_dependency build zlib-devel
Add_dependency build gnutls-devel
Add_dependency build postgresql-libs-devel
Add_dependency build libmysqlclient-devel

post_install()
{
	install -d ${DESTDIR}/etc/init.d ${DESTDIR}/etc/logrotate.d \
		${DESTDIR}/etc/conf.d
	install -m755 ${FILESDIR}/rsyslogd.rc ${DESTDIR}/etc/init.d/rsyslogd
	install -m644 ${FILESDIR}/rsyslogd.confd ${DESTDIR}/etc/conf.d/rsyslogd
	install -m644 ${FILESDIR}/rsyslog.conf ${DESTDIR}/etc/rsyslog.conf
	install -m644 ${FILESDIR}/rsyslog.logrotate \
		${DESTDIR}/etc/logrotate.d/rsyslog
}
