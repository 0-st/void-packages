# Template file for 'btrfs-progs'
pkgname=btrfs-progs
_distver=0.19
_snapver=20120328
version="${_snapver}.${_distver}"
wrksrc="${pkgname}-${_distver}.${_snapver}"
homepage="http://btrfs.wiki.kernel.org/"
distfiles="ftp://ftp.archlinux.org/other/$pkgname/$pkgname-${_distver}.${_snapver}.tar.xz"
short_desc="Btrfs filesystem utilities"
maintainer="Juan RP <xtraeme@gmail.com>"
license="GPL-2"
checksum=0c6dbd3df81429e7489b74d5780ffdbe1e46495d155123a7f13dff0d491570e2
long_desc="
 This packages provides the userspace utilities required to
 create/format/manipulate Btrfs filesystems."

Add_dependency build acl-devel
Add_dependency build libuuid-devel
Add_dependency build e2fsprogs-devel

do_build() {
	make ${makejobs}
}

do_install() {
	make prefix=${DESTDIR}/usr install

	# fix manpage location.
	vmkdir usr/share
	vmove usr/man usr/share

	# Install initramfs-tools stuff.
	vinstall ${FILESDIR}/btrfs.initramfs-hook \
		755 usr/share/initramfs-tools/hooks btrfs
	vinstall ${FILESDIR}/btrfs.initramfs-local-top \
		755 usr/share/initramfs-tools/scripts/local-top btrfs
}
