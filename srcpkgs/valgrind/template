# Template file for 'valgrind'
pkgname=valgrind
version=3.6.1
revision=2
patch_args="-Np1"
distfiles="http://www.valgrind.org/downloads/$pkgname-$version.tar.bz2"
build_style=gnu_configure
configure_args="--enable-tls --with-mpicc=/dev/null"
short_desc="Tool for finding memory management bugs in programs"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://valgrind.org/"
license="GPL-2"
checksum=49bdcc4fbcf060049b5f0dcfd8a187a6e90e0b0e57309f633b64e44430726a0e
long_desc="
 Valgrind is a tool to help you find memory-management problems in your
 programs. When a program is run under Valgrind's supervision, all
 reads and writes of memory are checked, and calls to
 malloc/new/free/delete are intercepted. As a result, Valgrind can
 detect a lot of problems that are otherwise very hard to find/diagnose."

subpackages="$pkgname-devel"
Add_dependency run glibc	">=2.14<2.15"
Add_dependency full perl	">=0"
Add_dependency build pkg-config

pre_configure()
{
	# 3.0 shouldn't be treated differently than 2.6 Linux kernels...
	sed -i -e "s|2.6.\*)|3.0.\*)|" configure
}
