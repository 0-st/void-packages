# Template file for 'squashfs-tools'
pkgname=squashfs-tools
version=4.1
wrksrc="squashfs${version}"
distfiles="${SOURCEFORGE_SITE}/squashfs/squashfs${version}.tar.gz"
build_style=custom-install
short_desc="Tool to create and append to squashfs filesystems"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=3a870d065a25b3f5467bc6d9ed34340befab51a3f9e4b7e3792ea0ff4e06046a
long_desc="
 Squashfs is a highly compressed read-only filesystem for Linux. It uses zlib
 compression to compress both files, inodes and directories. Inodes in the
 system are very small and all blocks are packed to minimise data overhead.
 Block sizes greater than 4K are supported up to a maximum of 64K.

 Squashfs is intended for general read-only filesystem use, for archival
 use (i.e. in cases where a .tar.gz file may be used), and in constrained
 block device/memory systems (e.g. embedded systems) where low overhead is
 needed."

Add_dependency run glibc
Add_dependency run zlib
Add_dependency run lzo
Add_dependency run liblzma

Add_dependency build zlib-devel
Add_dependency build lzo-devel
Add_dependency build liblzma-devel

do_build()
{
	cd ${wrksrc}/${pkgname} || return 1

	# Enable LZO and XZ support.
	sed -i 's|^#XZ_SUPPORT = 1|XZ_SUPPORT = 1|' Makefile
	sed -i 's|^#LZO_SUPPORT = 1|LZO_SUPPORT = 1|' Makefile

	make ${makejobs} || return 1
}

do_install()
{
	cd ${wrksrc}/${pkgname} || return 1

	install -d ${DESTDIR}/usr/bin
	install -m755 {mk,un}squashfs ${DESTDIR}/usr/bin
}
