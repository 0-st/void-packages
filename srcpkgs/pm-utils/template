# Template file for 'pm-utils'
pkgname=pm-utils
version=1.4.1
revision=6
patch_args="-Np1"
build_style=gnu-configure
configure_args="--libdir=/usr/lib"
depends="bash"
makedepends="xmlto"
fulldepends="procps dmidecode ethtool vbetool"
short_desc="Power Management Utilities"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://pm-utils.freedesktop.org"
license="GPL-2"
distfiles="
http://pm-utils.freedesktop.org/releases/$pkgname-$version.tar.gz
http://pm-utils.freedesktop.org/releases/pm-quirks-20100619.tar.gz"
checksum="
8ed899032866d88b2933a1d34cc75e8ae42dcde20e1cc21836baaae3d4370c0b
14a50518928c27417cdc8bcbabb32b3d986931de105149aa248d8883e56c61ec"
long_desc="
 The pm-utils package contains utilities and scripts useful for tasks related
 to power management."

post_install() {
	# Switch to /run.
	sed -i -e "s|/var/run/pm-utils|/run/pm-utils|g" \
		${DESTDIR}/usr/lib/pm-utils/pm-functions
	# nm >=0.8.2 has native udev suspend/resume support
	rm -f "${DESTDIR}/usr/lib/pm-utils/sleep.d/55NetworkManager"
	# Remove hooks that cause hardware failure or don't make sense at all
	for f in harddrive hal-cd-polling; do
		rm -f ${DESTDIR}/usr/lib/pm-utils/power.d/$f
	done
	mv ${XBPS_BUILDDIR}/video-quirks/*.quirkdb ${DESTDIR}/usr/lib/pm-utils
	rmdir ${XBPS_BUILDDIR}/video-quirks
}
