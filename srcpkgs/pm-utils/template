# Template file for 'pm-utils'
pkgname=pm-utils
version=1.4.1
revision=1
patch_args="-Np1"
distfiles="
http://pm-utils.freedesktop.org/releases/$pkgname-$version.tar.gz
http://pm-utils.freedesktop.org/releases/pm-quirks-20100619.tar.gz"
build_style=gnu_configure
configure_args="--libdir=/usr/lib --localstatedir=/var"
short_desc="Power Management Utilities"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://pm-utils.freedesktop.org"
license="GPL-2"
checksum="
8ed899032866d88b2933a1d34cc75e8ae42dcde20e1cc21836baaae3d4370c0b
14a50518928c27417cdc8bcbabb32b3d986931de105149aa248d8883e56c61ec"
long_desc="
 $pkgname is a small collection of scripts that handle suspend and
 resume on behalf of HAL (Hardware Abstraction Layer)."

Add_dependency full glibc
Add_dependency full bash
Add_dependency full procps
Add_dependency full vbetool
Add_dependency full dmidecode
Add_dependency build xmlto

post_install()
{
	# nm >=0.8.2 has native udev suspend/resume support
	rm -f "${DESTDIR}/usr/lib/pm-utils/sleep.d/55NetworkManager"
	# Remove hooks that cause hardware failure or don't make sense at all
	for f in harddrive disable_wol hal-cd-polling; do
		rm -f ${DESTDIR}/usr/lib/pm-utils/power.d/$f
	done
	# Install logrotate file.
	install -D -m644 ${FILESDIR}/$pkgname.logrotate \
		${DESTDIR}/etc/logrotate.d/$pkgname
	mv ${XBPS_BUILDDIR}/video-quirks/*.quirkdb ${DESTDIR}/usr/lib/pm-utils
}
