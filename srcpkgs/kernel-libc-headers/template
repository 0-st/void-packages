# Template file for 'kernel-libc-headers'
. ${XBPS_SRCPKGDIR}/kernel/common-vars

pkgname=kernel-libc-headers
build_style=custom-install
short_desc="The Linux kernel headers for development"
long_desc="
 This package provides the linux kernel headers for use in userspace."

bootstrap=yes
nostrip=yes

if [ -n "$BOOTSTRAP_PKG_REBUILD" ]; then
	Add_dependency build perl ">=0"
fi

do_build()
{
	env LANG=C make headers_check
}

do_install()
{
	env LANG=C make INSTALL_HDR_PATH=${DESTDIR}/usr headers_install
	# Install scsi/scsi.h header, required by eject and others.
	sed -i -e "/^\#include <linux\/scatterlist.h>$/d" include/scsi/scsi.h
	install -m644 include/scsi/scsi.h ${DESTDIR}/usr/include/scsi
}

post_install()
{
	# Remove unused files.
	rm -f $(find ${DESTDIR}/usr/include -name .install -or -name ..install.cmd)
}
