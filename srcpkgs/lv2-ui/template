# Template file for 'lv2-ui'
pkgname=lv2-ui
version=2.2
build_style=waf
homepage="http://lv2plug.in"
distfiles="http://lv2plug.in/spec/lv2-ui-2.2.tar.bz2"
short_desc="UI API for the LV2 plugin standard"
maintainer="davehome <davehome@redthumb.info.tm>"
license="LGPL-2.1, BSD"
checksum=d348acf4f1559800fe74cbc0ad8058e8db97d7d4913942f146cd1c86c5227db0
long_desc="
 LV2 is a plugin standard for audio systems. It defines a minimal yet
 extensible C API for plugin code and a format for plugin bundles.

 This is the UI API."

Add_dependency run glibc
Add_dependency build python
Add_dependency full lv2core

post_install()
{
	# This bit is from Arch
	# do the work of lv2config to own symlinks;
	#   - generate lv2 headers
	#   - see FS#23514
	local _ns=$(grep '^<http' manifest.ttl | sed 's|<http://\(.*\)>|\1|')
	local _name=${_ns/*\/}
	local _path="usr/include/lv2/${_ns%/*}"
	vmkdir "$_path"
	cd "${DESTDIR}/usr/include/lv2/${_ns%/*}" && \
		ln -s "../../../../../lib/lv2/$_name.lv2" "$_name"

	rm $(find ${DESTDIR} | grep "\.xbps" | xargs)
	rm $(find ${DESTDIR} | grep "wafbuild" | xargs)
}
