# Template file for 'tlsdate'
pkgname=tlsdate
version=0.0.10
revision=1
wrksrc="${pkgname}-${pkgname}-${version}"
build_style=gnu-configure
configure_args="--sbindir=/usr/bin
 --with-polarssl=no ac_cv_func_clock_gettime=yes"
if [ "$XBPS_TARGET_MACHINE" = "i686" ]; then
	configure_args+=" --disable-seccomp-filter"
fi
conf_files="/etc/tlsdate/tlsdated.conf"
make_dirs="/var/cache/tlsdated 0755 root root"
hostmakedepends="automake pkg-config libtool"
makedepends="libressl-devel dbus-devel libevent-devel"
short_desc="Secure parasitic rdate replacement using HTTPS"
maintainer="Christian Neukirchen <chneukirchen@gmail.com>"
license="BSD"
homepage="https://github.com/ioerror/tlsdate"
distfiles="https://github.com/ioerror/tlsdate/archive/${pkgname}-${version}.tar.gz"
checksum=f2e5b16cb2e85348ee0958467a1f575d1f5f9027bc0c759c78854586cdfbdd1d

pre_configure() {
	sh ./autogen.sh
}

post_install() {
	vlicense LICENSE
	rm ${DESTDIR}/usr/share/doc/${pkgname}/{TODO,LICENSE}
	vmkdir etc/sv
	vcopy ${FILESDIR}/tlsdated etc/sv
}
