# Template file for 'lvm2'
pkgname=lvm2
version=2.02.56
wrksrc=LVM2.${version}
distfiles="ftp://sources.redhat.com/pub/lvm2/LVM2.${version}.tgz"
build_style=gnu_configure
configure_args="--disable-selinux --enable-readline --enable-pkgconfig
 --enable-fsadm --enable-static_link --with-staticdir=/sbin"
make_install_target="DESTDIR=$XBPS_DESTDIR/$pkgname-$version
 sbindir=$XBPS_DESTDIR/$pkgname-$version/sbin
 libdir=$XBPS_DESTDIR/$pkgname-$version/lib
 install_device-mapper install_lvm2"
short_desc="Logical Volume Manager 2 utilities"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=9c96ef2cb4a9606cb6a4af795cbb5503b04d676179b0c70a9883593992622f43
long_desc="
 LVM2 includes all of the support for handling read/write operations on
 physical volumes (hard disks, RAID-Systems, magneto optical, etc.,
 multiple devices (MD), see mdadd(8) or even loop devices, see
 losetup(8)), creating volume groups (kind of virtual disks) from one
 or more physical volumes and creating one or more logical volumes
 (kind of logical partitions) in volume groups."

keep_empty_dirs=yes
subpackages="device-mapper"
conf_files="/etc/lvm/lvm.conf"
triggers="initramfs-tools"
openrc_services="lvm2 shutdown"

Add_dependency full glibc
Add_dependency full bash
Add_dependency full readline
Add_dependency run  device-mapper

post_install()
{
	local initramfsdir=${DESTDIR}/usr/share/initramfs-tools

	install -d ${DESTDIR}/etc/lvm/archive ${DESTDIR}/etc/lvm/backup \
		${DESTDIR}/etc/init.d ${initramfsdir}/scripts/local-top \
		${initramfsdir}/hooks
	install -m755 ${FILESDIR}/lvm2.initramfs-hook ${initramfsdir}/hooks/lvm2
	install -m755 ${FILESDIR}/lvm2.initramfs-local-top \
		${initramfsdir}/scripts/local-top/lvm2
	install -m755 ${FILESDIR}/lvm2.rc ${DESTDIR}/etc/init.d/lvm2
}
