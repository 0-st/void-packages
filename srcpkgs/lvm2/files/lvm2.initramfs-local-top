#!/bin/sh

PREREQ="mdadm mdrun multipath"

prereqs()
{
	echo "$PREREQ"
}

case $1 in
# get pre-requisites
prereqs)
	prereqs
	exit 0
	;;
esac

[ ! -e /sbin/lvm ] && exit 0
[ ! -e /dev/urandom ] && mknod /dev/urandom c 1 9

modprobe -q dm-mod >/dev/null 2>&1
if [ -e /sys/class/misc/device-mapper ]; then
	echo "Scanning for Logical Volumes..."
	/sbin/lvm vgscan --ignorelockingfailure
	echo "Activating Logical Volumes..."
	/sbin/lvm vgchange --ignoremonitoring --ignorelockingfailure -ay
fi
exit $?
