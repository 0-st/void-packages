# Template build file for 'wxPython'
pkgname=wxPython
version=2.8.12.1
distfiles="${SOURCEFORGE_SITE}/wxpython/${pkgname}-src-${version}.tar.bz2"
wrksrc="${pkgname}-src-${version}"
short_desc="The wxWidgets GUI toolkit library (Python Bindings)"
maintainer="davehome <davehome@redthumb.info.tm>"
homepage="http://www.wxwidgets.org/"
license="wxWindows"
checksum=1f3f153d9f1504c6ce2d2c4b23e940b8f58b81f4cba35cda1a5bb31142243cd0
long_desc="
 C++ library that lets developers create applications for Windows, OS X, Linux
 and UNIX on 32-bit and 64-bit architectures as well as several mobile
 platforms including Windows Mobile, iPhone SDK and embedded GTK+. It has
 popular language bindings for Python, Perl, Ruby and many other languages.

 Unlike other cross-platform toolkits, wxWidgets gives its applications a truly
 native look and feel because it uses the platform's native API rather than
 emulating the GUI. It's also extensive, free, open-source and mature.

 This package contains the python bindings."

Add_dependency build pkg-config
Add_dependency build zlib-devel
Add_dependency build libpng-devel
Add_dependency build jpeg-devel
Add_dependency build libXpm-devel
Add_dependency build tiff-devel
Add_dependency build expat-devel
Add_dependency build libX11-devel
Add_dependency build libXinerama-devel
Add_dependency build GConf-devel
Add_dependency build cairo-devel
Add_dependency build gtk+-devel
Add_dependency build MesaLib-devel
Add_dependency build wxGTK-devel
Add_dependency build python-devel # for Python.h

Add_dependency full python

subpackages="${pkgname}-devel"

pre_configure() {
	msg_normal "Replacing python interpreter with python2.7...\n"
	find . -type f -exec sed -i 's/env python/env python2\.7/' {} \;
	mv wxPython/wx/tools/Editra/editra wxPython/wx/tools/Editra/Editra
}

do_configure() {
	./configure --prefix=/usr --enable-monolithic --with-gtk=2 --with-x \
		--with-opengl --enable-unicode --enable-graphics_ctx \
		--enable-optimize --enable-mediactrl --with-regex=builtin \
		--with-libpng=sys --with-libxpm=sys --with-libjpeg=sys \
		--with-libtiff=sys --disable-precomp-headers
}

do_build() {
	cd wxPython && \
	python2.7 setup.py WXPORT=gtk2 UNICODE=1 build
}

do_install() {
	cd wxPython && \
	python2.7 setup.py WXPORT=gtk2 UNICODE=1 install --root="${DESTDIR}"
	vinstall ../docs/licence.txt 0644 \
		"usr/share/licenses/${pkgname}" LICENSE
}
