# Template build file for 'netsurf'.
pkgname=netsurf
version=2.9
revision=3
depends="desktop-file-utils shared-mime-info"
makedepends="pkg-config perl libjpeg-turbo-devel libmng-devel
 libpng-devel>=1.5.10 librsvg-devel libxml2-devel libcurl-devel
 lcms-devel libwebp-devel libparserutils-devel libwapcaplet-devel
 libhubbub-devel libcss-devel libnsbmp-devel libnsgif-devel gtk+-devel
 libglade-devel gstreamer-devel"
short_desc="Free, open source web browser written in C."
maintainer="davehome <davehome@redthumb.info.tm>"
license="GPL-2, MIT"
homepage="http://www.netsurf-browser.org"
distfiles="${homepage}/downloads/releases/${pkgname}-${version}-full-src.tar.gz"
checksum=ade6ade7f66ce2f0a80df724bafefd18c17165166111c490837737aa2e09ae9d

do_build() {
	make ${makejobs} --directory=${pkgname}-${version} \
		PREFIX=/usr TARGET=gtk NETSURF_USE_WEBP=YES \
		NETSURF_USE_VIDEO=YES
}

do_install() {
	make ${makejobs} --directory=${pkgname}-${version} \
		PREFIX=/usr DESTDIR=${DESTDIR} TARGET=gtk \
		NETSURF_USE_WEBP=YES NETSURF_USE_VIDEO=YES install

	# Install app icon (from Ubuntu)
	vinstall "${FILESDIR}/${pkgname}.png" \
		0644 usr/share/pixmaps

	# Install .desktop file (from Arch)
	vinstall "${FILESDIR}/${pkgname}.desktop" \
		0644 usr/share/applications

	# Install license
	vinstall "${wrksrc}/${pkgname}-${version}/COPYING" \
		0644 "/usr/share/licenses/${pkgname}"
}
