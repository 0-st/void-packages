# Template build file for 'netsurf'.
pkgname=netsurf
version=2.9
homepage="http://www.netsurf-browser.org"
distfiles="${homepage}/downloads/releases/${pkgname}-${version}-full-src.tar.gz"
short_desc="Free, open source web browser written in C."
maintainer="davehome <davehome@redthumb.info.tm>"
license="GPL-2, MIT"
checksum=ade6ade7f66ce2f0a80df724bafefd18c17165166111c490837737aa2e09ae9d
long_desc="
 Small as a mouse, fast as a cheetah and available for free. NetSurf is
 a multi-platform web browser for RISC OS, UNIX-like platforms (including
 Linux), Mac OS X, and more.

 Written in C, this award winning open source project features its own
 layout engine. It is licensed under GPL version 2.

 * Web standards: HTML 4.01 and CSS 2.1
 * Image formats: PNG, GIF, JPEG, SVG, JNG, MNG and BMP
 * HTTPS for secure online transactions
 * Unicode text
 * Web page thumbnailing
 * Local history trees
 * Global history
 * Hotlist manager (bookmarks)
 * Cookie manager
 * URL completion
 * Text selection
 * Scale view
 * Search-as-you-type text search highlighting
 * Save pages complete with images
 * Fast, lightweight layout and rendering engine"

Add_dependency build pkg-config
Add_dependency build perl
Add_dependency build jpeg-devel
Add_dependency build libmng-devel
Add_dependency build libpng-devel
Add_dependency build librsvg-devel
Add_dependency build libxml2-devel
Add_dependency build libcurl-devel
Add_dependency build lcms-devel
Add_dependency build libwebp-devel
Add_dependency build libparserutils-devel
Add_dependency build libwapcaplet-devel
Add_dependency build libhubbub-devel
Add_dependency build libcss-devel
Add_dependency build libnsbmp-devel
Add_dependency build libnsgif-devel
Add_dependency build gtk+-devel
Add_dependency build libglade-devel
Add_dependency build gstreamer-devel

Add_dependency run desktop-file-utils
Add_dependency run shared-mime-info

do_build() {
	make ${makejobs} --directory=${pkgname}-${version} \
		PREFIX=/usr TARGET=gtk NETSURF_USE_WEBP=YES \
		NETSURF_USE_VIDEO=YES
}

do_install() {
	make ${makejobs} --directory=${pkgname}-${version} \
		PREFIX=/usr DESTDIR=${DESTDIR} TARGET=gtk \
		NETSURF_USE_WEBP=YES NETSURF_USE_VIDEO=YES install

	# Install app icon (from Ubuntu)
	vinstall "${FILESDIR}/${pkgname}.png" \
		0644 usr/share/pixmaps

	# Install .desktop file (from Arch)
	vinstall "${FILESDIR}/${pkgname}.desktop" \
		0644 usr/share/applications

	# Install license
	vinstall "${wrksrc}/${pkgname}-${version}/COPYING" \
		0644 "/usr/share/licenses/${pkgname}"
}
