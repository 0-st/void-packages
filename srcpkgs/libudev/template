# Template file for 'libudev'
pkgname=libudev
version=198
revision=2
wrksrc="systemd-${version}"
build_style=gnu-configure
configure_args="--libexecdir=/usr/lib --disable-selinux
 --disable-static --disable-ima --enable-introspection=no
 --disable-kmod --disable-blkid --disable-chkconfig
 --disable-selinux --disable-tcpwrap --disable-pam
 --disable-acl --disable-xattr --disable-audit
 --disable-libcryptsetup --disable-qrencode --disable-microhttpd
 --disable-binfmt --disable-vconsole --disable-readahead --disable-bootchart
 --disable-quotacheck --disable-randomseed --disable-hostnamed
 --disable-timedated --disable-localed --disable-coredump
 --disable-myhostname --disable-gudev --disable-keymap --without-python"
makedepends="pkg-config intltool gperf dbus-devel libcap-devel liblzma-devel
 libgcrypt-devel libxslt docbook-xsl"
subpackages="libudev-devel systemd-libs systemd-devel"
short_desc="udev shared library"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.freedesktop.org/wiki/Software/systemd"
license="LGPL-2.1, GPL-2, MIT"
#distfiles="http://www.freedesktop.org/software/systemd/systemd-${version}.tar.xz"
distfiles="http://pkgs.fedoraproject.org/repo/pkgs/systemd/systemd-${version}.tar.xz/26a75e2a310f8c1c1ea9ec26ddb171c5/systemd-${version}.tar.xz"
checksum=444492355e5ff0ad99e0691ecaff1081ee8d45901580f47ba8b74e56107c71bf

if [ -n "$XBPS_CROSS_TRIPLET" ]; then
	makedepends="automake gettext-devel pkg-config intltool
		gperf libxslt docbook-xsl libgcrypt-devel" 
	crossmakedepends="dbus-devel libcap-devel liblzma-devel libgcrypt-devel"
	pre_configure() {
		autoreconf -fi
	}
fi

post_install() {
	# We are only interested in shlibs, headers and pc files.
	rm -rf ${DESTDIR}/{etc,var}
	rm -rf ${DESTDIR}/usr/{bin,sbin}
	rm -rf ${DESTDIR}/usr/lib/{udev,systemd,tmpfiles.d}
	rm -rf ${DESTDIR}/usr/share/{bash*,doc,polkit-1,dbus-1}
}
