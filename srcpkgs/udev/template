# Template file for 'udev'
pkgname=udev
version=182
revision=1
distfiles="${KERNEL_SITE}/utils/kernel/hotplug/udev-${version}.tar.xz"
build_style=gnu-configure
configure_args="--sbindir=/sbin --without-selinux --libexecdir=/lib
--with-rootlibdir=/lib --disable-introspection --enable-floppy
--with-systemdsystemunitdir=/lib/systemd/system --disable-gudev
--disable-static --disable-rule-generator
--with-firmware-path=/lib/firmware/updates:/lib/firmware
--with-pci-ids-path=/usr/share/hwdata/pci.ids
--with-usb-ids-path=/usr/share/hwdata/usb.ids"
makedepends="pkg-config gperf libxslt libblkid-devel libkmod-devel"
fulldepends="hwids"
systemd_services="udev.service on"
conf_files="/etc/udev/udev.conf"
subpackages="libudev libudev-devel"
short_desc="/dev/ and hotplug management daemon"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.kernel.org/pub/linux/utils/kernel/hotplug/udev.html"
license="GPL-2"
checksum=adb8892f3b8e4b7163703ed4a545774721a3d55a1062de001f08c477c03d97ab
long_desc="
 udev is a daemon which dynamically creates and removes device nodes from
 /dev/, handles hotplug events and loads drivers at boot time."

post_install() {
        # Install the initramfs-tools hook/scripts.
	vinstall ${FILESDIR}/udev.initramfs-hook 755 \
		usr/share/initramfs-tools/hooks udev
	vinstall ${FILESDIR}/udev.initramfs-inittop 755 \
		usr/share/initramfs-tools/scripts/init-top udev
	vinstall ${FILESDIR}/udev.initramfs-bottom 755 \
		usr/share/initramfs-tools/scripts/init-bottom udev

	# udevd has been moved to /lib/udev, make a symlink.
	vmkdir sbin
	cd ${DESTDIR}/sbin && ln -sf ../lib/udev/udevd .
	# compat symlink to udevadm.
	cd ${DESTDIR}/sbin && ln -sf ../usr/bin/udevadm .
}
