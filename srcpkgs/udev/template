# Template file for 'udev'
pkgname=udev
version=175
#distfiles="${KERNEL_SITE}/utils/kernel/hotplug/udev-${version}.tar.bz2"
distfiles="http://people.freedesktop.org/~kay/udev/udev-${version}.tar.bz2"
build_style=gnu-configure
configure_args="--sbindir=/sbin --without-selinux --libexecdir=/lib/udev
--with-rootlibdir=/lib --disable-introspection --enable-edd --enable-floppy
--with-systemdsystemunitdir=/lib/systemd/system --disable-gudev
--enable-udev_acl --disable-static --disable-rule-generator"
short_desc="/dev/ and hotplug management daemon"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.kernel.org/pub/linux/utils/kernel/hotplug/udev.html"
license="GPL-2"
checksum=4c7937fe5a1521316ea571188745b9a00a9fdf314228cffc53a7ba9e5968b7ab
long_desc="
 udev is a daemon which dynamically creates and removes device nodes from
 /dev/, handles hotplug events and loads drivers at boot time."

systemd_services="udev.service"
conf_files="/etc/udev/udev.conf"
subpackages="libudev libudev-devel"

Add_dependency run glibc
Add_dependency run glib
Add_dependency run acl

Add_dependency build pkg-config
Add_dependency build gperf
Add_dependency build glib-devel
Add_dependency build acl-devel

Add_dependency full usbutils	">=0.82"
Add_dependency full pciutils

post_install()
{
	# Install some additional rules.
	install -m644 rules/misc/* ${DESTDIR}/lib/udev/rules.d

        # Install the initramfs-tools hook/scripts.
	vinstall ${FILESDIR}/udev.initramfs-hook 755 \
		usr/share/initramfs-tools/hooks udev
	vinstall ${FILESDIR}/udev.initramfs-inittop 755 \
		usr/share/initramfs-tools/scripts/init-top udev
	vinstall ${FILESDIR}/udev.initramfs-bottom 755 \
		usr/share/initramfs-tools/scripts/init-bottom udev

	# udevd has been moved to /lib/udev, make a symlink.
	vmkdir sbin
	cd ${DESTDIR}/sbin && ln -sf ../lib/udev/udevd .
}
