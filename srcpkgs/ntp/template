# Template file for 'ntp'
pkgname=ntp
version=4.2.6p2
distfiles="http://archive.ntp.org/ntp4/$pkgname-$version.tar.gz"
build_style=gnu_configure
configure_args="--enable-linuxcaps --enable-getifaddrs=glibc
--enable-all-clocks --enable-parse-clocks --with-crypto=openssl
--enable-accurate-adjtime --without-rpath --enable-ipv6"
short_desc="The Network Time Protocol"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=42898b7903a2da04a242885c92919903d56ee69c0293ec828568cab71dd3e9d8
long_desc="
 The Network Time Protocol (NTP) is used to synchronize a computer's
 time with another reference time source. This package includes ntpd
 (a daemon which continuously adjusts system time) and utilities used
 to query and configure the ntpd daemon."

subpackages="$pkgname-perl"
conf_files="/etc/ntp.conf"
openrc_services="ntpd default true"
system_accounts="ntpd"
ntpd_homedir="/var/chroot/ntpd"

Add_dependency run glibc
Add_dependency run readline
Add_dependency run libssl
Add_dependency run libcap
Add_dependency build readline-devel
Add_dependency build openssl-devel
Add_dependency build libcap-devel

post_install()
{
	install -d ${DESTDIR}/var/chroot/ntpd
	install -d ${DESTDIR}/etc/init.d ${DESTDIR}/etc/conf.d
	install -d ${DESTDIR}/usr/share/ntp ${DESTDIR}/etc/cron.hourly
	install -d ${DESTDIR}/usr/share/doc/ntp
	install -m 644 ${FILESDIR}/ntpd.confd ${DESTDIR}/etc/conf.d/ntpd
	install -m 755 ${FILESDIR}/ntpd.rc ${DESTDIR}/etc/init.d/ntpd
	install -m 644 ${FILESDIR}/ntp.conf ${DESTDIR}/etc/ntp.conf
	install -m 744 ${FILESDIR}/ntpd.cron-hourly \
		${DESTDIR}/etc/cron.hourly/ntpd_recheck
	cp -a ${wrksrc}/html ${DESTDIR}/usr/share/doc/ntp
	cp -a ${wrksrc}/conf ${DESTDIR}/usr/share/ntp
}
