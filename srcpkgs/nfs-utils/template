# Template file for 'nfs-utils'
pkgname=nfs-utils
version=1.2.7
revision=2
build_style=gnu-configure
configure_args="--with-statduser=nobody --enable-gss --enable-nfsv4
 --with-statedir=/var/lib/nfs --enable-libmount-mount
 --without-tcp-wrappers --enable-ipv6 --sbindir=/usr/sbin"
short_desc="Network File System client utilities"
maintainer="Juan RP <xtraeme@gmail.com>"
license="GPL-2"
homepage="http://nfs.sourceforge.net"
distfiles="${KERNEL_SITE}/utils/${pkgname}/${version}/${pkgname}-${version}.tar.xz"
checksum=d78768a0819c5eeed5e5abb6c4c9048962e9f8b9ef45451ea4db6aee38720121

depends="rpcbind"
subpackages="$pkgname-server"
makedepends="pkg-config libblkid-devel libmount-devel libtirpc-devel
 librpcsecgss-devel libnfsidmap-devel libevent-devel device-mapper-devel
 libcap-devel mit-krb5-devel sqlite-devel"

conf_files="/etc/idmapd.conf"

make_dirs="
/var/lib/nfs/rpc_pipefs	0755	root	root
/var/lib/nfs/sm		0750	root	root"

post_install() {
	vmove "sbin/*" usr/sbin
	# conffiles
	vinstall ${FILESDIR}/exports 644 etc
	vinstall ${FILESDIR}/idmapd.conf 644 etc
	# systemd glue
	vmkdir usr/lib/systemd/system
	install -m644 ${FILESDIR}/*.{service,mount} \
		${DESTDIR}/usr/lib/systemd/system
}
