# Template build file for 'libxml2'.
pkgname=libxml2
version=2.8.0
revision=2
build_style=gnu-configure
configure_args="--disable-static --with-threads --with-history"
subpackages="$pkgname-devel $pkgname-python"
makedepends="ncurses-devel readline-devel liblzma-devel python-devel"
crossmakedepends="zlib-devel ${makedepends}"
short_desc="Library providing XML and HTML support"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.xmlsoft.org/"
license="MIT"
distfiles="http://xmlsoft.org/sources/$pkgname-$version.tar.gz"
checksum=f2e2d0e322685193d1affec83b21dc05d599e17a7306d7b90de95bb5b9ac622a

if [ -n "$XBPS_CROSS_TRIPLET" ]; then
	makedepends="automake gettext-devel ${makedepends}"
	pre_configure() {
		sed -e "s|AM_CONFIG_HEADER|AC_CONFIG_HEADERS|g" -i configure.in
		autoreconf -fi
	}
	pre_build() {
		sed -e "s|/usr/\(include/python2.7\)|/usr/$XBPS_CROSS_TRIPLET/\1|g" \
			-e "s|/usr/\(lib/python2.7/site-packages\)|/usr/$XBPS_CROSS_TRIPLET/\1|g" \
			-i python/Makefile
	}
fi

post_install() {
	vinstall COPYING 644 usr/share/licenses/${pkgname}
}
