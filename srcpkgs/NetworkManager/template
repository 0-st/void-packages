# Template file for 'NetworkManager'
pkgname=NetworkManager
version=0.9.2.0
distfiles="${GNOME_SITE}/$pkgname/0.9/$pkgname-$version.tar.xz"
build_style=gnu-configure
configure_args="--with-distro=gentoo
--with-dhcpcd=/sbin/dhcpcd --with-dhclient=no --disable-wimax
--with-system-ca-path=/etc/ssl/certs --enable-more-warnings=no
--with-crypto=nss --disable-static --enable-ppp
--with-systemdsystemunitdir=/lib/systemd/system"
short_desc="Network Management daemon"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.gnome.org/projects/NetworkManager/"
license="GPL-2"
checksum=437af9132a6fe1ff603cd981c0cfaa4557592b34782f9705e708d61365226ddf
long_desc="
 NetworkManager attempts to keep an active network connection available at all
 times. It is intended only for the desktop use-case, and is not intended for
 usage on servers. The point of NetworkManager is to make networking
 configuration and setup as painless and automatic as possible. If using DHCP,
 NetworkManager is _intended_ to replace default routes, obtain IP addresses
 from a DHCP server, and change nameservers whenever it sees fit."

systemd_services="${pkgname}.service on"
conf_files="/etc/${pkgname}/${pkgname}.conf"
subpackages="$pkgname-devel libnm"

# Required dirs at run time.
make_dirs="
/etc/${pkgname}/dispatcher.d 		0755 root root
/etc/${pkgname}/system-connections 	0755 root root
/var/lib/${pkgname} 			0700 root root"

Add_dependency run glibc
Add_dependency run libnm
Add_dependency run libuuid
Add_dependency run nss
Add_dependency run nspr
Add_dependency run dbus-glib
Add_dependency run dbus-libs
Add_dependency run glib
Add_dependency run libgudev
Add_dependency run libnl3
Add_dependency run polkit

Add_dependency build pkg-config
Add_dependency build intltool
Add_dependency build libuuid-devel
Add_dependency build nss-devel
Add_dependency build dbus-glib-devel
Add_dependency build libgudev-devel
Add_dependency build wireless_tools-devel
Add_dependency build libnl3-devel
Add_dependency build polkit-devel
Add_dependency build ppp-devel
Add_dependency build iptables-devel

Add_dependency full dnsmasq
Add_dependency full dbus		">=0"
Add_dependency full iproute2
Add_dependency full dhcpcd
Add_dependency full wpa_supplicant

post_install()
{
	# Install config file.
	install -m644 ${FILESDIR}/*.conf ${DESTDIR}/etc/NetworkManager
	rm -rf ${DESTDIR}/etc/init.d
}
