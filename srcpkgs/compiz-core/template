# Template file for 'compiz-core'
pkgname=compiz-core
version=0.9.2.1
distfiles="http://releases.compiz.org/$version/$pkgname-$version.tar.bz2"
build_style=custom-install
short_desc="Composite window manager"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=acb4380ce5711adbfbaa43b44c5ed94f366459d92cc18917a7036a62a39d5c4a
long_desc="
 Compiz is a compositing window manager that uses 3D graphics acceleration
 via OpenGL. It provides various new graphical effects and features on
 any desktop environment, including Gnome and KDE."

subpackages="$pkgname-devel"

gconf_schemas="
compiz-copytex.schemas
compiz-imgpng.schemas
compiz-scale.schemas
compiz-blur.schemas
compiz-obs.schemas
compiz-opengl.schemas
compiz-gnomecompat.schemas
compiz-annotate.schemas
compiz-fade.schemas
compiz-glib.schemas
compiz-cube.schemas
compiz-switcher.schemas
compiz-dbus.schemas
compiz-decor.schemas
compiz-inotify.schemas
compiz-clone.schemas
compiz-composite.schemas
compiz-regex.schemas
compiz-compiztoolbox.schemas
compiz-water.schemas
compiz-rotate.schemas
compiz-screenshot.schemas
compiz-imgsvg.schemas
compiz-core.schemas
gwd.schemas
compiz-move.schemas
compiz-wobbly.schemas
compiz-place.schemas
compiz-commands.schemas
compiz-zoom.schemas
compiz-ini.schemas
compiz-resize.schemas"

Add_dependency run libgcc
Add_dependency run glibc
Add_dependency run libstdc++
Add_dependency run libX11
Add_dependency run libXrandr
Add_dependency run libXinerama
Add_dependency run libXext
Add_dependency run libSM
Add_dependency run libICE
Add_dependency run startup-notification
Add_dependency run libXrender
Add_dependency run libwnck
Add_dependency run gtk+
Add_dependency run atk
Add_dependency run gdk-pixbuf
Add_dependency run pango
Add_dependency run cairo
Add_dependency run glib
Add_dependency run GConf
Add_dependency run metacity
Add_dependency run libXdamage
Add_dependency run MesaLib
Add_dependency run libXfixes
Add_dependency run libXcomposite
Add_dependency run librsvg
Add_dependency run libpng
Add_dependency run dbus-libs
Add_dependency run boost

Add_dependency build pkg-config 
Add_dependency build intltool
Add_dependency build cmake
Add_dependency build boost-devel
Add_dependency build libX11-devel
Add_dependency build libXrandr-devel
Add_dependency build libXinerama-devel
Add_dependency build libXext-devel
Add_dependency build libSM-devel
Add_dependency build libICE-devel
Add_dependency build startup-notification-devel
Add_dependency build glibc-devel
Add_dependency build libstdc++-devel
Add_dependency build libXrender-devel
Add_dependency build libwnck-devel
Add_dependency build gtk+-devel
Add_dependency build atk-devel
Add_dependency build gdk-pixbuf-devel
Add_dependency build pango-devel
Add_dependency build cairo-devel
Add_dependency build glib-devel
Add_dependency build GConf-devel
Add_dependency build metacity-devel
Add_dependency build libXdamage-devel
Add_dependency build MesaLib-devel
Add_dependency build libXfixes-devel
Add_dependency build libXcomposite-devel
Add_dependency build librsvg-devel
Add_dependency build libpng-devel
Add_dependency build dbus-devel

do_build()
{
	mkdir -p ${wrksrc}/build && cd ${wrksrc}/build || return 1

	cmake -DCMAKE_BUILD_TYPE=Release \
		-DCMAKE_INSTALL_PREFIX=/usr \
		-DBUILD_GNOME=yes -DBUILD_GTK=yes \
		-DBUILD_KDE4=no \
		-DBUILD_METACITY=yes \
		-DCOMPIZ_DISABLE_SCHEMAS_INSTALL=yes \
		.. || return 1

	make ${makejobs} || return 1
}

do_install()
{
	cd ${wrksrc}/build || return 1
	make DESTDIR=${DESTDIR} install || return 1
	make DESTDIR=${DESTDIR} findcompiz_install || return 1
}
