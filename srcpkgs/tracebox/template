# Template file for 'tracebox'
pkgname=tracebox
version=0.2
revision=1
_click_version=2.0.1
build_style=gnu-configure
hostmakedepends="automake pkg-config libtool unzip"
makedepends="libpcap-devel lua-devel"
short_desc="A middlebox detection tool"
maintainer="Jürgen Buchmüller <pullmoll@t-online.de>"
license="GPL-2"
nocross=yes
homepage="http://www.tracebox.org/"
distfiles="https://github.com/tracebox/tracebox/archive/v${version}.tar.gz>tracebox-${version}.tar.gz https://github.com/bhesmans/click/archive/v${_click_version}.tar.gz>click-${_click_version}.tar.gz https://codeload.github.com/gdetal/libcrafter/zip/master>libcrafter-master.zip"
checksum="39a7a70edb386defe03fabafe0ec8dd448ec8a24adcb2df8ea70f4ea16dfffd8 4e48591cb385000ee8daedf3cc18d4b00a9c5a142cc001e0780f0c7ebd713764 b19a46a26f5f3caeebd8adb4cc818cf92e0f71d1d515ef2259129ef6e5095c78"

pre_configure() {
	# Do what ./bootstrap.sh would have done but without using git to pull submodules
	mkdir -p ${wrksrc}/test/tools ${wrksrc}/noinst/libcrafter
	mv -v ../click-${_click_version} test/tools/click
	mv -v ../libcrafter-master/{.gitignore,README,libcrafter} noinst/libcrafter
	rmdir -v ../libcrafter-master
	AUTOHEADER=true autoreconf --install --verbose
}
