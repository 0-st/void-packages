# Template file for 'openssl'
pkgname=openssl
_openssl_version=1.0.0
version=${_openssl_version}
distfiles="http://www.openssl.org/source/$pkgname-$version.tar.gz"
build_style=configure
configure_script="./config"
configure_args="--prefix=/usr --openssldir=/etc/ssl --libdir=lib
zlib shared threads -Wa,--noexecstack"
make_install_target="INSTALL_PREFIX=$XBPS_DESTDIR/$pkgname-$version
MANDIR=/usr/share/man install"
short_desc="Secure Socket Layer and cryptographic library"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=1bbf9afc5a6215121ac094147d0a84178294fe4c3d0a231731038fd3717ba7ca
long_desc="
 The OpenSSL Project is a collaborative effort to develop a robust,
 commercial-grade, full-featured, and Open Source toolkit implementing the
 Secure Sockets Layer (SSL v2/v3) and Transport Layer Security (TLS v1)
 protocols as well as a full-strength general purpose cryptography library."

# Does not build with -j.
disable_parallel_build=yes
conf_files="/etc/ssl/openssl.cnf"
subpackages="openssl-devel"

Add_dependency run glibc
Add_dependency run zlib
Add_dependency build perl
Add_dependency build zlib-devel

post_install()
{
	for _solib_ in libssl.so libcrypto.so; do
		cd ${DESTDIR}/usr/lib && \
			ln -s ${_solib_}.${version} ${_solib_}.1
	done
}
