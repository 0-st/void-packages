# Template build file for 'libjpeg-turbo'.
pkgname=libjpeg-turbo
version=1.1.1
revision=1
homepage="http://libjpeg-turbo.virtualgl.org/"
distfiles="${SOURCEFORGE_SITE}/${pkgname}/${pkgname}-${version}.tar.gz"
build_style=gnu_configure
configure_args="--with-jpeg8"
short_desc="Derivative of libjpeg which uses SIMD instructions"
maintainer="Juan RP <xtraeme@gmail.com>"
license="LGPL-2.1, ${pkgname}"
checksum=553b1f5a968fb9efc089623ed99be2aa6bc21586be92eb04848489c91a63f1e2
long_desc="
 $pkgname is a derivative of libjpeg which uses SIMD instructions
 MMX, SSE2, etc. to accelerate baseline JPEG compression and decompression
 on x86, x86-64, and other supported systems. On such systems, $pkgname is
 generally 2-4x as fast as the unmodified version of libjpeg, all else being
 equal."

provides="jpeg-8"
replaces="jpeg>=0"
subpackages="${pkgname}-devel ${pkgname}-tools"

Add_dependency run glibc
Add_dependency build nasm

post_install() {
	vinstall jpegint.h 644 usr/include
	vinstall LICENSE.txt 644 usr/share/licenses/${pkgname}
	vinstall ${FILESDIR}/${pkgname}.virtualpkgd \
		644 etc/xbps/virtualpkg.d ${pkgname}

	rm -f ${DESTDIR}/usr/bin/jpegut
	rm -f ${DESTDIR}/usr/bin/jpgtest
	rm -f ${DESTDIR}/usr/lib/libturbojpeg*
	rm -f ${DESTDIR}/usr/include/turbojpeg.h
}
