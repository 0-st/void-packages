# INSTALL
DISTFILE="https://dl.google.com/linux/direct/google-chrome-stable_current_amd64.deb"
BUILD_DIR="./var/tmp/$PKGNAME.build"
case "$ACTION" in
pre)
    # Actions to execute before the package files are unpacked.
    mkdir -p $BUILD_DIR
    xbps-uhelper fetch "${DISTFILE}>$BUILD_DIR/$PKGNAME.deb"
    ;;
post)
    # Things that have to happen no matter what
    ar x "$BUILD_DIR/$PKGNAME.deb"
    tar xf data.tar.xz
    mv $BUILD_DIR/opt/google/chrome/libwidevinecdm.so usr/lib/${PKGNAME}
    mv $BUILD_DIR/opt/google/chrome/libwidevinecdmadapter.so usr/lib/${PKGNAME}

    if [ "$UPDATE" = "yes" ]; then
        # actions to execute if package is being updated.
	...
    else
        # actions to execute if package is being installed.
        ln -s usr/lib/$PKGNAME/libwidevinecdm.so usr/lib/chromium
        ln -s usr/lib/$PKGNAME/libwidevinecdmadapter.so usr/lib/chromium
    fi
    rm -r $BUILD_DIR
    chmod 775 usr/lib/$PKGNAME/libwidevinecdm.so
    chmod 775 usr/lib/$PKGNAME/libwidevinecdmadapter.so
    ;;
esac
