# Template file for 'udisks'
pkgname=udisks
version=1.0.2
revision=2
distfiles="http://hal.freedesktop.org/releases/$pkgname-$version.tar.gz"
build_style=gnu_configure
configure_args="--disable-static --localstatedir=/var --enable-lvm2"
short_desc="Disk Management Service"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=7dc1a150a6a31b2727144603fa5a8f9852696fc5bdc4a11917b9b0f1b8e3dcf1
long_desc="
 UPower is an abstraction for enumerating power devices, listening to device
 events and querying history and statistics. Any application or service on
 the system can access the org.freedesktop.UPower service via the system
 message bus. Some operations (such as suspending the system) are restricted
 using PolicyKit."

keep_empty_dirs=yes

Add_dependency run glibc
Add_dependency run glib
Add_dependency run device-mapper
Add_dependency run libudev
Add_dependency run libparted
Add_dependency run libatasmart
Add_dependency run polkit
Add_dependency run dbus-glib
Add_dependency run dbus-libs
Add_dependency run libgudev
Add_dependency run libsgutils
Add_dependency run liblvm2app

Add_dependency build pkg-config
Add_dependency build intltool
Add_dependency build libxslt
Add_dependency build docbook-xsl
Add_dependency build liblvm2app-devel
Add_dependency build glib-devel
Add_dependency build device-mapper-devel
Add_dependency build libudev-devel
Add_dependency build libparted-devel
Add_dependency build libatasmart-devel
Add_dependency build polkit-devel
Add_dependency build dbus-glib-devel
Add_dependency build dbus-devel
Add_dependency build libgudev-devel
Add_dependency build sg3_utils-devel

Add_dependency full udev

post_install()
{
	# Fix location for bash completion stuff.
	install -d ${DESTDIR}/etc/bash_completion.d
	mv ${DESTDIR}/etc/profile.d/*.sh ${DESTDIR}/etc/bash_completion.d
	chmod 644 ${DESTDIR}/etc/bash_completion.d/*.sh
	rmdir ${DESTDIR}/etc/profile.d

	# Fix location of pkg-config files.
	mv ${DESTDIR}/usr/share/pkgconfig ${DESTDIR}/usr/lib
	rm -rf ${DESTDIR}/var/run
}
