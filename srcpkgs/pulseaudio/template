# Template file for 'pulseaudio'
pkgname=pulseaudio
version=2.0
revision=2
distfiles="$FREEDESKTOP_SITE/$pkgname/releases/$pkgname-$version.tar.xz"
build_style=gnu-configure
configure_args="--disable-oss-output --disable-oss-wrapper --disable-tcpwrap
--enable-jack --disable-lirc --disable-hal --disable-hal-compat
--disable-gconf --with-database=tdb --enable-orc"
short_desc="A featureful, general-purpose sound server"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.freedesktop.org/wiki/Software/PulseAudio"
license="LGPL-2"
checksum=28b42edd42f4879a6884af5f0ec11801ac001eb7582881215b36649aa37e2061
long_desc="
 PulseAudio, previously known as Polypaudio, is a sound server for POSIX and
 WIN32 systems. It is a drop in replacement for the ESD sound server with much
 better latency, mixing/re-sampling quality and overall architecture.

 These are some of PulseAudio's features:

  * High quality software mixing of multiple audio streams with support for
    more than one sink/source. May be used to combine multiple sound cards
    into one (with sample rate adjustment).

  * Wide range of supported client libraries. ESD, ALSA, oss, libao and
    GStreamer client applications are supported as-is. Native PulseAudio
    plug-ins are also available for xmms and mplayer.

  * Good low latency behaviour and very accurate latency measurement for
    playback and recording. Ability to fully synchronize multiple playback
    streams.

  * Network transparency, allowing an application to play back or record
    audio on a different machine than the one it is running on.

  * Extensible plug-in architecture with plug-ins for jackd, multicast-rtp
    lirc and avahi, just to name a few."

subpackages="libpulseaudio $pkgname-devel"

shlib_depends="libpulseaudio>=${version}"

conf_files="
/etc/pulse/system.pa
/etc/pulse/daemon.conf
etc/pulse/client.conf
/etc/pulse/default.pa"

Add_dependency build pkg-config
Add_dependency build intltool
Add_dependency build zlib-devel
Add_dependency build gtk+-devel
Add_dependency build libltdl-devel
Add_dependency build speex-devel
Add_dependency build libXi-devel
Add_dependency build libXtst-devel
Add_dependency build xcb-util-devel
Add_dependency build libxcb-devel
Add_dependency build libsndfile-devel
Add_dependency build libasyncns-devel
Add_dependency build dbus-devel
Add_dependency build tdb-devel
Add_dependency build libcap-devel
Add_dependency build libbluetooth-devel
Add_dependency build avahi-libs-devel
Add_dependency build alsa-lib-devel
Add_dependency build libudev-devel
Add_dependency build openssl-devel
Add_dependency build libsamplerate-devel
Add_dependency build json-c-devel
Add_dependency build orc-devel
Add_dependency build glib-devel
Add_dependency build jack-devel
Add_dependency build fftw-devel
Add_dependency build systemd-devel
Add_dependency build webrtc-audio-processing-devel

Add_dependency full rtkit

post_install() {
	vinstall ${FILESDIR}/pulseaudio.xinit 755 \
		etc/X11/xinit/xinitrc.d pulseaudio
	rm -f ${DESTDIR}/etc/dbus-1/system.d/pulseaudio-system.conf
}
