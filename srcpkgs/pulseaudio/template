# Template file for 'pulseaudio'
pkgname=pulseaudio
version=0.9.21
revision=2
distfiles="http://0pointer.de/lennart/projects/$pkgname/$pkgname-$version.tar.gz"
build_style=gnu_configure
configure_args="--disable-samplerate --disable-oss-output --disable-oss-wrapper
--disable-jack --disable-lirc --disable-hal --disable-hal-compat
--with-database=gdbm --localstatedir=/var LDFLAGS="
short_desc="A featureful, general-purpose sound server"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=94e22356ac70ee95388ae58da90d88c6b3186d1938618d21671627ff56cee254
long_desc="
 PulseAudio, previously known as Polypaudio, is a sound server for POSIX and
 WIN32 systems. It is a drop in replacement for the ESD sound server with much
 better latency, mixing/re-sampling quality and overall architecture.

 These are some of PulseAudio's features:

  * High quality software mixing of multiple audio streams with support for
    more than one sink/source. May be used to combine multiple sound cards
    into one (with sample rate adjustment).

  * Wide range of supported client libraries. ESD, ALSA, oss, libao and
    GStreamer client applications are supported as-is. Native PulseAudio
    plug-ins are also available for xmms and mplayer.

  * Good low latency behaviour and very accurate latency measurement for
    playback and recording. Ability to fully synchronize multiple playback
    streams.

  * Network transparency, allowing an application to play back or record
    audio on a different machine than the one it is running on.

  * Extensible plug-in architecture with plug-ins for jackd, multicast-rtp
    lirc and avahi, just to name a few."

subpackages="libpulseaudio $pkgname-devel"

conf_files="
/etc/pulse/system.pa
/etc/pulse/daemon.conf
/etc/pulse/client.conf
/etc/pulse/default.pa"

Add_dependency run glibc
Add_dependency run zlib
Add_dependency run glib
Add_dependency run libltdl
Add_dependency run tcp_wrappers-libs
Add_dependency run libspeex
Add_dependency run libsndfile
Add_dependency run libasyncns
Add_dependency run dbus-libs
Add_dependency run gdbm
Add_dependency run libcap
Add_dependency run libbluetooth
Add_dependency run alsa-lib
Add_dependency run libudev
Add_dependency run libssl
Add_dependency run avahi-libs
Add_dependency run libSM
Add_dependency run libICE
Add_dependency run libXtst
Add_dependency run libX11
Add_dependency run GConf
Add_dependency run libpulseaudio

Add_dependency build pkg-config
Add_dependency build gettext
Add_dependency build GConf-devel
Add_dependency build glib-devel
Add_dependency build libltdl-devel
Add_dependency build speex-devel
Add_dependency build libX11-devel
Add_dependency build libSM-devel
Add_dependency build libICE-devel
Add_dependency build libXtst-devel
Add_dependency build tcp_wrappers-devel
Add_dependency build libsndfile-devel
Add_dependency build libasyncns-devel
Add_dependency build dbus-devel
Add_dependency build gdbm-devel
Add_dependency build libcap-devel
Add_dependency build libbluetooth-devel
Add_dependency build avahi-libs-devel
Add_dependency build alsa-lib-devel
Add_dependency build libudev-devel
Add_dependency build openssl-devel
Add_dependency build zlib-devel

Add_dependency full rtkit

post_install()
{
	install -Dm755 ${FILESDIR}/pulseaudio.xinit \
		${DESTDIR}/etc/X11/xinit/xinitrc.d/pulseaudio

	rm ${DESTDIR}/etc/dbus-1/system.d/pulseaudio-system.conf
}
