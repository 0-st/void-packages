# Template file for 'pciutils'
pkgname=pciutils
version=3.1.8
homepage="http://mj.ucw.cz/pciutils.html"
distfiles="ftp://atrey.karlin.mff.cuni.cz/pub/linux/pci/${pkgname}-${version}.tar.gz"
short_desc="PCI bus related utilities"
maintainer="Juan RP <xtraeme@gmail.com>"
license="GPL-2"
checksum=15a7de19f23f95eeda2487bedc6b4c11eddea9c30bba35573775b4d46b7a46ca
long_desc="
 The $pkgname package contains various utilities for inspecting and
 setting devices connected to the PCI bus."

subpackages="$pkgname-devel"
Add_dependency run glibc
Add_dependency build wget

do_build() {
	./update-pciids.sh
	make OPT="${XBPS_CFLAGS} -fPIC -DPIC" ZLIB=no SHARED=no PREFIX=/usr \
		SHAREDIR=/usr/share/hwdata MANDIR=/usr/share/man all
	cp lib/libpci.a ${XBPS_MASTERDIR}/tmp
	make clean
	make OPT="${XBPS_CFLAGS} -fPIC -DPIC" ZLIB=no SHARED=yes PREFIX=/usr \
		SHAREDIR=/usr/share/hwdata MANDIR=/usr/share/man all
}

do_install() {
	make SHARED=yes PREFIX=/usr SHAREDIR=/usr/share/hwdata \
		MANDIR=/usr/share/man DESTDIR=${DESTDIR} install install-lib
	vinstall ${XBPS_MASTERDIR}/tmp/libpci.a 644 usr/lib
}
