# Template file for 'buildbot'
pkgname=buildbot
version=0.8.7
revision=1
build_style=python-module
fulldepends="python python-jinja sqlalchemy-migrate python-simplejson Twisted"
short_desc="A system to automate the compile/test cycle"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://trac.buildbot.net/"
license="GPL-2"
distfiles="http://buildbot.googlecode.com/files/$pkgname-$version.tar.gz"
checksum=1f4539d2da282aa39495c7e2e4cef7abb3a3bd3617524650846116f2bcc63b2f
long_desc="
 The BuildBot is a system to automate the compile/test cycle required by most
 software projects to validate code changes. By automatically rebuilding and
 testing the tree each time something has changed, build problems are
 pinpointed quickly, before other developers are inconvenienced by the failure.
 The guilty developer can be identified and harassed without human intervention.

 By running the builds on a variety of platforms, developers who do not have the
 facilities to test their changes everywhere before checkin will at least know
 shortly afterwards whether they have broken the build or not. Warning counts,
 lint checks, image size, compile time, and other build parameters can be
 tracked over time, are more visible, and are therefore easier to improve."

noarch=yes
pycompile_module="$pkgname"

pre_install() {
	sed -i -e "s|usr/bin/tail|bin/tail|g" buildbot/scripts/logwatcher.py
}

post_install() {
	# Install all contrib modules.
	local contribdir=${DESTDIR}/usr/share/buildbot/contrib

	vmkdir usr/share/buildbot/contrib
	install -m755 ${wrksrc}/contrib/*.py ${contribdir}
}
