# Template file for 'ipe'
pkgname=ipe
version=7.1.5
revision=2
hostmakedepends="pkg-config git"
makedepends="qt-devel lua-devel libjpeg-turbo-devel cairo-devel poppler-devel"
short_desc="Drawing editor for creating figures in PDF or EPS formats"
maintainer="Christian Neukirchen <chneukirchen@gmail.com>"
license="GPL-3, GPL-2"
homepage="http://ipe7.sourceforge.net/"
distfiles="${SOURCEFORGE_SITE}/ipe7/${pkgname}/${version%.*}/${pkgname}-${version}-src.tar.gz"
checksum="fe63a0511bd52d4e256b06f35ce8abc5610267a10594280ca0aaaf15c6e27b1a"

do_fetch() {
	# ipe-tools
	local url="git://github.com/otfried/ipe-tools.git"
	msg_normal "Fetching source from ${url}...\n"
	git clone ${url} ${pkgname}-${version}
}

do_build() {
	make ${makejobs} -C src IPEPREFIX=/usr LUA_PACKAGE=lua
	make ${makejobs} -C figtoipe
	make ${makejobs} -C pdftoipe
}

do_install() {
	make -C src install IPEPREFIX=/usr LUA_PACKAGE=lua INSTALL_ROOT=${DESTDIR}
	vbin figtoipe/figtoipe
	vbin pdftoipe/pdftoipe
	vbin svgtoipe/svgtoipe.py svgtoipe
}

ipe-devel_package() {
	depends="${sourcepkg}>=${version}_${revision}"
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove "usr/lib/*.so"
		vmove "usr/share/ipe/$version/doc"
	}
}
