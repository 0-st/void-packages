# Template file for 'xbps-git'
pkgname=xbps-git
version=20130205
revision=1
build_style=configure
configure_args="--prefix=/ --exec-prefix=/usr --sbindir=/usr/sbin
 --enable-static --enable-debug"
short_desc="The XBPS package system (development branch)"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://code.google.com/p/xbps"
license="Simplified BSD"

nofetch=yes
noextract=yes
provides="xbps-${version}"
replaces="xbps>=0 xbps-devel>=0"
conf_files="/etc/xbps/xbps.conf"
subpackages="libxbps-git libxbps-devel-git xbps-static-git"

do_fetch() {
	local url="git://github.com/xtraeme/xbps"
	msg_normal "Fetching source from $url ...\n"
	git clone ${url} ${pkgname}-${version}
}

depends="xbps-triggers libxbps>=${version}"
makedepends="git which pkg-config"
crossmakedepends="proplib-devel>=0.6.2 openssl-devel libfetch-devel
 libarchive-devel confuse-devel"

if [ -n "$XBPS_CROSS_TRIPLET" ]; then
	subpackages="libxbps-git libxbps-devel-git xbps-static-git"
	configure_script="env PKG_CONFIG_LIBDIR=/usr/${XBPS_CROSS_TRIPLET}/lib/pkgconfig ./configure"
else
	configure_args="${configure_args} --enable-tests"
	makedepends="${makedepends} proplib-devel openssl-devel libarchive-devel"
	makedepends="${makedepends} libfetch-devel confuse-devel atf-devel>=0.16"
	subpackages="${subpackages} xbps-tests-git"
fi
