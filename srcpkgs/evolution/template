# Template file for 'evolution'
pkgname=evolution
version=3.2.3
homepage="http://www.gnome.org"
distfiles="${GNOME_SITE}/$pkgname/3.2/$pkgname-$version.tar.xz"
build_style=gnu-configure
configure_args="--disable-pst-import --with-clutter --with-openldap
--with-krb5=/usr --disable-schemas-install --disable-scrollkeeper
--disable-static --with-gconf-schema-file-dir=/usr/share/gconf/schemas"
short_desc="Integrated mail, addressbook and calendaring"
maintainer="davehome <davehome@redthumb.info.tm>"
license="GPL-2"
checksum=a25d523e775c022ec9e68d7b989316e7252b687d70b9db2f60b72bb833099e9d
long_desc="
 Evolution provides integrated mail, addressbook and calendaring functionality
 to users of the GNOME desktop."

gconf_schemas="
apps_evolution_shell.schemas
evolution-mail.schemas
apps-evolution-mail-notification.schemas
apps-evolution-attachment-reminder.schemas
apps_evolution_email_custom_header.schemas
apps_evolution_eplugin_face.schemas
apps-evolution-template-placeholders.schemas
apps_evolution_addressbook.schemas
evolution-bogofilter.schemas
apps_evolution_calendar.schemas
apps-evolution-mail-prompts-checkdefault.schemas
evolution-spamassassin.schemas"

subpackages="lib${pkgname} ${pkgname}-devel"
gtk_iconcache_dirs="/usr/share/icons/hicolor"

Add_dependency build pkg-config
Add_dependency build intltool
Add_dependency build gnome-doc-utils
Add_dependency build evolution-data-server-devel
Add_dependency build gtk+3-devel
Add_dependency build glib-devel
Add_dependency build libical-devel
Add_dependency build GConf-devel
Add_dependency build mx-devel
Add_dependency build clutter-gtk-devel
Add_dependency build libcanberra-devel
Add_dependency build gtkhtml-devel
Add_dependency build nss-devel
Add_dependency build libSM-devel
Add_dependency build libICE-devel
Add_dependency build clutter-devel
Add_dependency build cogl-devel
Add_dependency build json-glib-devel
Add_dependency build MesaLib-devel
Add_dependency build libXi-devel
Add_dependency build libdrm-devel
Add_dependency build libX11-devel
Add_dependency build libXext-devel
Add_dependency build libXdamage-devel
Add_dependency build libXcomposite-devel
Add_dependency build libXfixes-devel
Add_dependency build enchant-devel
Add_dependency build sqlite-devel
Add_dependency build libsoup-devel
Add_dependency build nspr-devel
Add_dependency build libxml2-devel
Add_dependency build gnome-desktop-devel
Add_dependency build atk-devel
Add_dependency build pango-devel
Add_dependency build gdk-pixbuf-devel
Add_dependency build cairo-devel
Add_dependency build freetype-devel
Add_dependency build fontconfig-devel
Add_dependency build libldap-devel
Add_dependency build libsoup-gnome-devel
Add_dependency build libnotify-devel
Add_dependency build gnome-online-accounts-devel
Add_dependency build libgdata-devel
Add_dependency build gstreamer-devel
Add_dependency build libgweather-devel
Add_dependency build mit-krb5-devel
Add_dependency build NetworkManager-devel

Add_dependency full hicolor-icon-theme
Add_dependency full desktop-file-utils
Add_dependency full gsettings-desktop-schemas
Add_dependency full iso-codes

post_install() {
	mv ${DESTDIR}/usr/share/gconf/schemas/*.schemas ${wrksrc}
	for f in ${gconf_schemas}; do
		gconf-merge-schema ${DESTDIR}/usr/share/gconf/schemas/${f} \
			--domain ${pkgname}-3.2 ${wrksrc}/${f}
	done
}
