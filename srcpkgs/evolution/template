# Template file for 'evolution'
pkgname=evolution
version=3.4.4
revision=1
build_style=gnu-configure
configure_args="--disable-pst-import --with-clutter --with-openldap
--with-krb5=/usr --disable-schemas-install --disable-scrollkeeper
--disable-static --with-gconf-schema-file-dir=/usr/share/gconf/schemas"
makedepends="which pkg-config intltool gnome-doc-utils evolution-data-server-devel
gtk+3-devel libical-devel GConf-devel mx-devel clutter-gtk-devel libcanberra-devel
gtkhtml-devel nss-devel clutter-devel json-glib-devel libXfixes-devel enchant-devel
sqlite-devel libsoup-devel libxml2-devel gnome-desktop-devel libldap-devel
libsoup-gnome-devel libnotify-devel gnome-online-accounts-devel libgdata-devel
gstreamer-devel libgweather-devel mit-krb5-devel NetworkManager-devel"
depends="hicolor-icon-theme desktop-file-utils"
fulldepends="gsettings-desktop-schemas iso-codes"
short_desc="Integrated mail, addressbook and calendaring"
maintainer="davehome <davehome@redthumb.info.tm>"
license="GPL-2"
homepage="http://www.gnome.org"
distfiles="${GNOME_SITE}/$pkgname/3.4/$pkgname-$version.tar.xz"
checksum=3b57f6c1f61993771f0b63c11287ced17ae44b5007ba1a27f14fcb0a1ec0dfcc
long_desc="
 Evolution provides integrated mail, addressbook and calendaring functionality
 to users of the GNOME desktop."

gconf_schemas="
apps-evolution-attachment-reminder.schemas
apps-evolution-mail-notification.schemas
apps-evolution-mail-prompts-checkdefault.schemas
apps-evolution-template-placeholders.schemas
apps_evolution_addressbook.schemas
apps_evolution_calendar.schemas
apps_evolution_email_custom_header.schemas
apps_evolution_eplugin_face.schemas
apps_evolution_shell.schemas
evolution-bogofilter.schemas
evolution-mail.schemas
evolution-spamassassin.schemas"

gtk_iconcache_dirs="/usr/share/icons/hicolor"

post_install() {
	mv ${DESTDIR}/usr/share/gconf/schemas/*.schemas ${wrksrc}
	for f in ${gconf_schemas}; do
		gconf-merge-schema ${DESTDIR}/usr/share/gconf/schemas/${f} \
			--domain ${pkgname}-3.2 ${wrksrc}/${f}
	done
	# Remove devel stuff, not interested.
	rm -rf ${DESTDIR}/usr/include
	rm -rf ${DESTDIR}/usr/lib/pkgconfig
	rm -rf ${DESTDIR}/usr/share/gtk-doc
}
