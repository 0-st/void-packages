# Template file for 'dracut'
pkgname=dracut
version=014
revision=3
distfiles="${KERNEL_SITE}/utils/boot/$pkgname/$pkgname-$version.tar.xz"
build_style=gnu-makefile
make_build_args="sysconfdir=/etc"
make_install_args="sysconfdir=/etc"
depends="busybox psmisc>=22.14_2"
makedepends="libxslt docbook-xsl"
short_desc="A new initramfs infrastructure"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=8766a0eecd51b4bc6647e7870ba269dffbbbe21954984b23c77f21ce1fd034d1
long_desc="
 Unlike existing initramfs, this is an attempt at having as little as possible
 hard-coded into the initramfs as possible. The initramfs has (basically) one
 purpose in life -- getting the rootfs mounted so that we can transition to the
 real rootfs. This is all driven off of device availability. Therefore, instead
 of scripts hard-coded to do various things, we depend on udev to create device
 nodes for us and then when we have the rootfs's device node, we mount and
 carry on. Having the root on MD, LVM2, LUKS is supported as well as NFS,
 iSCSI, NBD and FCOE with dracut-network."

noarch=yes
subpackages="dracut-network"
conf_files="/etc/dracut.conf"
make_dirs="/etc/dracut.conf.d 0755 root root"



pre_install() {
	# fix path to busybox.
	sed -i "s|/sbin/busybox|/bin/busybox|g" \
		modules.d/05busybox/module-setup.sh
}
