# Template build file for 'xbps-src-utils'.
pkgname=xbps-src-utils
version=20130221
revision=1
homepage="https://github.com/davehome/xbps-src-utils"
makedepends="git pkg-config flex libxbps-devel>=0.19"
short_desc="Various tools for xbps-src in C (like repo-checkvers)"
maintainer="davehome <davehome@redthumb.info.tm>"
license="Simplified BSD"
long_desc="
 Various tools for xbps-src in C (like repo-checkvers)

 * The xbps-repo-checkvers program shows which XBPS binary packages need to be
   rebuilt on your system by comparing the versions of the binary packages which
   are available in the XBPS repositories registered in your xbps.conf with the
   latest available versions of them in the source package tree."

nofetch=yes
noextract=yes

if [ -n "$XBPS_CROSS_TRIPLET" ]; then
	makedepends="git pkg-config flex"
	crossmakedepends="libfl-devel libxbps-devel"
fi

do_fetch() {
	local url="git://github.com/davehome/xbps-src-utils.git"
	msg_normal " Fetching source from $url ...\n"
	git clone ${url} ${pkgname}-${version}
}

do_configure() {
	if [ -n "$XBPS_CROSS_TRIPLET" ]; then
		_pcenv="env PKG_CONFIG_LIBDIR=/usr/$XBPS_CROSS_TRIPLET/lib/pkgconfig"
	fi
	${_pcenv} ./configure --prefix=/usr --etcdir=/etc
}

do_build() {
	make
}

do_install() {
	make DESTDIR=${DESTDIR} install
}
