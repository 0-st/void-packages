# Template file for 'gtk-vnc'
pkgname=gtk-vnc
version=0.4.4
revision=3
subpackages="gtk2-vnc gtk2-vnc-devel gtk2-vnc-python gtk-vnc-devel"
makedepends="perl>=0 pkg-config intltool gobject-introspection gtk+3-devel
 gnutls-devel>=3.1.5 libsasl-devel vala-devel python-devel pygtk-devel"
short_desc="VNC viewer widget for GTK"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.gnome.org"
license="GPL-2"
distfiles="${GNOME_SITE}/$pkgname/0.4/$pkgname-$version.tar.xz"
checksum=c93fdb53c78b52a1cfa067c1a0be0b93d4adfc17ccea1215f20eeab2818308b7

post_extract() {
	cp -a ${wrksrc} /tmp/gtk2-build
	cp -a ${wrksrc} /tmp/gtk3-build
	mv /tmp/gtk[23]-build ${wrksrc}
}

do_configure() {
	cd ${wrksrc}/gtk2-build
	./configure ${CONFIGURE_SHARED_ARGS} --with-python \
		--disable-static --with-gtk=2.0

	cd ${wrksrc}/gtk3-build
	./configure ${CONFIGURE_SHARED_ARGS} --with-python \
		--disable-static --with-gtk=3.0
}

do_build() {
	cd ${wrksrc}/gtk2-build && make ${makejobs}
	cd ${wrksrc}/gtk3-build && make ${makejobs}
}

do_install() {
	cd ${wrksrc}/gtk2-build && make DESTDIR=${DESTDIR} install
	cd ${wrksrc}/gtk3-build && make DESTDIR=${DESTDIR} install
}
