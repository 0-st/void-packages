# Template file for 'schroot'
pkgname=schroot
version=1.6.10
revision=2
build_style=gnu-configure
configure_args="
	--enable-dchroot
	--enable-lvm-snapshot
	--enable-btrfs-snapshot
	--enable-block-device
	--enable-loopback
	--enable-uuid
	BTRFS=/usr/bin/btrfs
	BTRFSCTL=/usr/bin/btrfsctl
	LVCREATE=/usr/sbin/lvcreate
	LVREMOVE=/usr/sbin/lvremove"
conf_files="
	/etc/schroot/minimal/nssdatabases
	/etc/schroot/minimal/fstab
	/etc/schroot/minimal/copyfiles
	/etc/schroot/buildd/nssdatabases
	/etc/schroot/buildd/fstab
	/etc/schroot/buildd/copyfiles
	/etc/schroot/default/nssdatabases
	/etc/schroot/default/fstab
	/etc/schroot/default/copyfiles
	/etc/schroot/setup.d/05lvm
	/etc/schroot/setup.d/50chrootname
	/etc/schroot/setup.d/70services
	/etc/schroot/setup.d/15killprocs
	/etc/schroot/setup.d/00check
	/etc/schroot/setup.d/20nssdatabases
	/etc/schroot/setup.d/20copyfiles
	/etc/schroot/setup.d/99check -> 00check
	/etc/schroot/setup.d/05union
	/etc/schroot/setup.d/10mount
	/etc/schroot/setup.d/05btrfs
	/etc/schroot/setup.d/05file
	/etc/schroot/setup.d/15binfmt
	/etc/schroot/schroot.conf
	/etc/schroot/desktop/nssdatabases
	/etc/schroot/desktop/fstab
	/etc/schroot/desktop/copyfiles
	/etc/schroot/sbuild/nssdatabases
	/etc/schroot/sbuild/fstab
	/etc/schroot/sbuild/copyfiles"
make_dirs="
	/var/lib/schroot/unpack 0755 root root
	/var/lib/schroot/union/underlay 0755 root root
	/var/lib/schroot/union/overlay 0755 root root
	/var/lib/schroot/session 0755 root root
	/var/lib/schroot/mount 0755 root root
	/etc/schroot/chroot.d 0755 root root"
hostmakedepends="cmake pkg-config"
makedepends="boost-devel pam-devel lockdev-devel libuuid-devel e2fsprogs-devel"
short_desc="Allows users to execute commands in different chroots"
maintainer="Andrea Brancaleoni <miwaxe@gmail.com>"
license="GPL-3"
homepage="https://wiki.debian.org/Schroot"
distfiles="${DEBIAN_SITE}/main/s/${pkgname}/${pkgname}_${version}.orig.tar.xz"
checksum="3ce8dfd9cb97b099e4b6d4ccec421d6cc8c9ef84574681e928a12badb5643d0b"

post_install() {
	vmkdir usr/share/bash-completion/completions
	mv ${DESTDIR}/etc/bash_completion.d/* ${DESTDIR}/usr/share/bash-completion/completions
}

schroot-devel_package() {
	short_desc+=" - development files"
	pkg_install() {
		vmove usr/include
		vmove "usr/lib/*.a"
		vmove usr/lib/pkgconfig
	}
}
