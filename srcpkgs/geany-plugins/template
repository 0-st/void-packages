# Template file for 'geany-plugins'
pkgname=geany-plugins
version=1.25
revision=1
build_style=gnu-configure
# XXX: gitchangebar plugin not compatible with libgit2 right now
configure_args="--enable-all-plugins --disable-gitchangebar"
hostmakedepends="automake gettext-devel intltool libtool pkg-config vala
 glib-devel python-devel"
makedepends="geany-devel lua51-devel ctpl-devel libwnck2-devel GConf-devel
 webkitgtk2-devel zlib-devel gpgme-devel enchant-devel pygtk-devel"
_short_desc="Geany IDE plugins"
short_desc="${_short_desc} meta-package"
maintainer="Steve Prybylski <sa.prybylx@gmail.com>"
license="GPL-2"
homepage="http://plugins.geany.org"
distfiles="https://github.com/geany/geany-plugins/archive/1.25.tar.gz"
checksum=626e606b5766685c86bae622f78912900b95b4a1c43c086ed9a3862691f8b257

replaces="geany-plugins<${version}"

if [ "$CROSS_BUILD" ]; then
	# these plugins break cross-compile
	configure_args+=" --disable-geanypy --disable-markdown"
fi

pre_configure() {
	NOCONFIGURE=1 ./autogen.sh
}

# these plugins require extra dependencies
geany-plugins-extra_package() {
	short_desc="${_short_desc} - extra plugins"
	pkg_install() {
		for p in devhelp geanygendoc geanylua geanypg geanypy geniuspaste \
			markdown pretty-printer spellcheck updatechecker webhelper; do
			if [ -x ${DESTDIR}/usr/lib/geany/${p}.so ]; then
				vmove usr/lib/geany/${p}.so
			fi
			if [ -x ${DESTDIR}/usr/share/geany-plugins/${p} ]; then
				vmove usr/share/geany-plugins/${p}
			fi
			if [ -x ${DESTDIR}/usr/share/doc/geany-plugins/${p} ]; then
				vmove usr/share/doc/geany-plugins/${p}
			fi
		done
	}
}

