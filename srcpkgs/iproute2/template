# Template file for 'iproute2'
pkgname=iproute2
version=2.6.39
patch_args="-Np1"
#distfiles="http://devresources.linux-foundation.org/dev/iproute2/download/iproute2-$version.tar.gz"
distfiles="http://ftp-nyc.osuosl.org/pub/lfs/lfs-packages/lfs-packages-svn-20110904/$pkgname-$version.tar.gz"
short_desc="IP Routing Utilities"
maintainer="Juan RP <xtraeme@gmail.com>"
homepage="http://www.linux-foundation.org/en/Net:Iproute2"
license="GPL-2"
checksum=939df14f3eef81f22719e4db59e3b16b89c644d2d85ce7453c069baecf21bdbf
long_desc="
 Iproute2 is a collection of utilities for controlling TCP/IP networking
 and traffic control in Linux."

conf_files="
/etc/iproute2/ematch_map
/etc/iproute2/rt_dsfield
/etc/iproute2/rt_protos
/etc/iproute2/rt_realms
/etc/iproute2/rt_scopes
/etc/iproute2/rt_tables"

Add_dependency run glibc
Add_dependency run libdb
Add_dependency run iptables

Add_dependency build perl	">=0"
Add_dependency build db-devel
Add_dependency build iptables-devel
Add_dependency build bison
Add_dependency build flex

do_build()
{
	sed -i -e "s|\/usr\/local\/lib|\/usr\/libexec|g" configure
	./configure --prefix=/usr
	make ${makejobs}
}

do_install()
{
	make DESTDIR=${DESTDIR} install

	# Remove tex and sgml files.
	rm -f ${DESTDIR}/usr/share/doc/iproute2/*.{tex,sgml}
	# Remove devel manpages.
	rm -rf ${DESTDIR}/usr/share/man/man3

	# OpenRC expects this in /sbin.
	install -d ${DESTDIR}/sbin
	mv ${DESTDIR}/usr/sbin/ip ${DESTDIR}/sbin
}
