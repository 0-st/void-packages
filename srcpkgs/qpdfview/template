# Template file for 'qpdfview'
pkgname=qpdfview
version=0.4.11.1
revision=1
hostmakedepends="pkg-config qt-qmake"
makedepends="qt-devel poppler-qt4-devel libspectre-devel djvulibre-devel file-devel cups-devel"
depends="desktop-file-utils hicolor-icon-theme"
short_desc="A tabbed document viewer using Qt and the poppler library"
maintainer="Alessio Sergi <al3hex@gmail.com>"
homepage="https://launchpad.net/qpdfview"
license="GPL-2"
distfiles="https://launchpad.net/${pkgname}/trunk/${version}/+download/${pkgname}-${version}.tar.gz"
checksum=e8ffbe23d30bd04e9178277f48154053d98154a219d10b60e9e910d3328fe60b

pre_configure() {
	sed -i '/^Icon=/s|=.*|=qpdfview|' miscellaneous/${pkgname}.desktop.in
}

do_configure() {
	lrelease ${pkgname}.pro
	qmake QMAKE_CFLAGS="${CFLAGS}" QMAKE_CXXFLAGS="${CXXFLAGS}" QMAKE_LFLAGS="${LDFLAGS}" QMAKE_STRIP="" ${pkgname}.pro
}

do_build() {
	make ${makejobs}
}

do_install() {
	make INSTALL_ROOT=${DESTDIR} install
}

post_install() {
	install -Dm644 icons/${pkgname}.svg ${DESTDIR}/usr/share/icons/hicolor/scalable/apps/${pkgname}.svg
}
