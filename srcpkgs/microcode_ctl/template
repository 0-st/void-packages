# Template file for 'microcode_ctl'
pkgname=microcode_ctl
version=1.17
patch_args="-Np1"
distfiles="http://www.urbanmyth.org/microcode/$pkgname-$version.tar.gz"
short_desc="Intel IA32/IA64 CPU Microcode Utility"
make_install_args="PREFIX=/usr MANDIR=/usr/share/man/man8"
maintainer="Juan RP <xtraeme@gmail.com>"
checksum=41ef081c3a2649ca012714a3e2034d748612b1a8f007aa275f395f81cb230bb7
long_desc="
 The microcode_ctl utility is a companion to the IA32 microcode driver:

  - it decodes and sends new microcode to the kernel driver for Intel IA32
    family (Pentium Pro, PII, Celeron, PIII, Xeon, Pentium 4, etc.) and
    Intel x86_64 family processors;
  - it signals the kernel driver to release any buffers it may hold.

 The microcode update does not permanently alter the CPU and must be performed
 each time the system is booted."

openrc_services="${pkgname} default true"

Add_dependency run glibc
Add_dependency full udev
Add_dependency full module-init-tools
Add_dependency full intel-microcode

do_build()
{
	make
}

do_install()
{
	install -D -m755 ${pkgname} ${DESTDIR}/usr/sbin/${pkgname}
	install -D -m644 ${pkgname}.8 ${DESTDIR}/usr/share/man/man8/${pkgname}.8
	install -D -m755 ${FILESDIR}/${pkgname}.rc \
		${DESTDIR}/etc/init.d/${pkgname}
}
