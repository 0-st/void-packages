# Template file for 'cinnamon'
pkgname=cinnamon
version=1.6.0
revision=6
wrksrc="linuxmint-Cinnamon-bd02368"
build_style=gnu-configure
configure_args="--disable-schemas-compile --enable-compile-warnings=yes
--disable-static --with-ca-certificates=/etc/ssl/certs/ca-certificates.crt"
makedepends="which gnome-common gettext-devel automake gnome-doc-utils
pkg-config intltool glib-devel dbus-glib-devel libxml2-devel gtk+3-devel>=3.6.0_2
libmuffin-devel>=1.1.0_2 gjs-devel gnome-menus-devel>=3.6.0 GConf-devel libsoup-devel
MesaLib-devel cogl-devel>=1.12 clutter-devel>=1.12 startup-notification-devel libcanberra-devel
polkit-devel NetworkManager-devel libgnome-keyring-devel>=3.6.0 libcroco-devel
gnome-desktop-devel>=3.6.0 gnome-bluetooth-devel>=3.6.0 pulseaudio-devel gobject-introspection"
depends="desktop-file-utils caribou pulseaudio mesa-demos muffin>=1.1.0
python-gconf python-lxml python-imaging"
fulldepends="gsettings-desktop-schemas"
short_desc="The Cinnamon desktop (gnome-shell fork)"
maintainer="Juan RP <xtraeme@gmail.com>"
license="GPL-2"
homepage="http://cinnamon.linuxmint.com/"
distfiles="http://xbps.nopcode.org/distfiles/${pkgname}-${version}.tar.gz"
checksum=905783fb3e12bc159f6a715800e974e292fb31478a3478eb2775670f2d4db4f3
long_desc="
 Cinnamon is a Linux desktop which provides advanced innovative features and
 a traditional user experience.

 The desktop layout is similar to Gnome 2. 
 The underlying technology is forked from Gnome Shell.
 The emphasis is put on making users feel at home and providing them with an
 easy to use and comfortable desktop experience."

pycompile_dirs="usr/lib/cinnamon-settings usr/lib/cinnamon-menu-editor"
LDFLAGS="-lgthread-2.0"

pre_configure() {
	_cur="/usr/lib/gnome-session/gnome-session-check-accelerated"
	_new="/usr/libexec/gnome-session-check-accelerated"

	# Fix path to gnome-session-check-accelerated
	sed -i -e "s|${_cur}|${_new}|g" \
		files/usr/share/gnome-session/sessions/cinnamon.session
	./autogen.sh

	# Workaround for 'Unknown attribute IN (Gtk.ShadowType)' in
	# cinnamon-settings.
	sed -i -e "s|Gtk.ShadowType.IN|Gtk.ShadowType.NONE|g" \
		files/usr/lib/cinnamon-settings/cinnamon-settings.py
}
