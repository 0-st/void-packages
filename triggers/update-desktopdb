#!/bin/sh
#
# Updates the MIME database that connects with applications, through
# the update-desktop-database(1) utility.
#
# Arguments:	$1 = action [run/targets]
#		$2 = target [post-install/post-remove]
#		$3 = pkgname
#		$4 = version
#
trigger="update-desktopdb"
desktopdb_bin=./usr/bin/update-desktop-database
desktopdb_dir=./usr/share/applications
desktopdb_cache=${desktopdb_dir}/mimeinfo.cache

case "$1" in
targets)
	echo "post-install post-remove"
	;;
run)
	echo "Running $trigger trigger..."

	case "$2" in
	post-*)
		if [ -f ${desktopdb_cache} ]; then
			rm -f ${desktopdb_cache}
		fi
		if [ -x ${desktopdb_bin} ]; then
			echo "Updating MIME database for ${desktopdb_dir}..."
			${desktopdb_bin} ${desktopdb_dir}
		fi
		;;
	esac
	;;
*)
	exit 1
	;;
esac

exit 0
