#!/bin/sh
#
# Updates GTK+ icon cache file with gtk-update-icon-cache(1).
#
# Arguments:	$1 = action [run/targets]
#		$2 = target [post-install/post-remove]
#		$3 = pkgname
#		$4 = version
#
trigger="gtk-icon-cache"
iconcache_bin=./usr/bin/gtk-update-icon-cache

case "$1" in
targets)
	echo "post-install post-remove"
	;;
run)
	echo "Running $trigger trigger..."

	case "$2" in
	post-*)
		for dir in ${gtk_iconcache_dirs}; do
			if [ -f ${dir}/icon-theme.cache ]; then
				rm -f ${dir}/icon-theme.cache
				echo "Removed GTK+ icon theme cache for ${dir}."
			fi
			if [ -x ${iconcache_bin} ]; then
				echo -n "Updating GTK+ icon cache for "
				echo -n "${dir}... "
				${iconcache_bin} -q -f -t ${dir}
				echo "done."
			fi
		done
		;;
	esac
	;;
*)
	exit 1
	;;
esac

exit 0
